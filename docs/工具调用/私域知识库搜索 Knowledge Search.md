# 私域知识库搜索 Knowledge Search
{"version":"1.2.31","data":{"0":{"ops":[{"insert":"*","attributes":{"lineId":"rys890rsmm","lmkr":"1"}},{"insert":"私域知识库搜索工具 Knowledge Search 支持通过 Responses API 调用直接获取企业私域知识库中的信息（如内部文档、产品手册、行业资料等），适用于需基于企业专属数据解答问题的场景（如内部培训问答、产品功能咨询、行业方案查询等）。工具通过模型自动判断是否需要调用私域知识库，支持与自定义 Function、MCP 等工具混合使用，目前仅支持旗舰版知识库。\n"},{"insert":"*","attributes":{"lineId":"rz4nr0rt7h","lmkr":"1","tips":"{\"type\":\"tip\",\"isTitle\":true}"}},{"insert":"说明\n"},{"insert":"*","attributes":{"lineId":"rz7gi0ruml","lmkr":"1","tips":"{\"type\":\"tip\"}"}},{"insert":"测试期间调用此工具需要增加 header '"},{"insert":"ark-beta-knowledge-search: true","attributes":{"inlineCode":"true"}},{"insert":"'，调用方式请参见"},{"insert":"快速开始","attributes":{"hyperlink":"{\"href\":\"/docs/82379/1873396#eabed668\",\"linkId\":\"RmrMEPaNkn\",\"newTab\":true}"}},{"insert":"。\n"},{"insert":"*","attributes":{"anchor":"#520b9a86","heading":"h2","lineId":"rz9q20rv31","lmkr":"1"}},{"insert":"核心功能","attributes":{"bold":"true"}},{"insert":"\n"},{"insert":"*","attributes":{"lineId":"rzbxn0rw5j","list":"number1","lmkr":"1","origin-start":"1","start":"1"}},{"insert":"精准私域检索","attributes":{"bold":"true"}},{"insert":"：仅检索企业已授权的私域知识库，保障数据安全性，适用于内部敏感信息查询场景。\n"},{"insert":"*","attributes":{"lineId":"rzeoq0rxs1","list":"number1","lmkr":"1","origin-start":"2","start":"2"}},{"insert":"灵活参数配置","attributes":{"bold":"true"}},{"insert":"：支持设置搜索结果数量、关键词并行数、结果重排、获取切片中图片等参数，适配不同查询需求（如精准查询需减少结果数量，全面查询需增加关键词并行数）。\n"},{"insert":"*","attributes":{"anchor":"#186f4304","heading":"h2","lineId":"rzgvh0rytn","lmkr":"1"}},{"insert":"前提条件","attributes":{"bold":"true"}},{"insert":"\n"},{"insert":"*","attributes":{"lineId":"rzj7j0rz9o","list":"bullet1","lmkr":"1","origin-start":"1","start":"1"}},{"insert":"获取 API Key","attributes":{"hyperlink":"{\"href\":\"https://console.volcengine.com/ark/region:ark+cn-beijing/apiKey\",\"linkId\":\"BAfBH7QlMc\",\"newTab\":true}"}},{"insert":"\n"},{"insert":"*","attributes":{"lineId":"rzlg80s0pu","list":"bullet1","lmkr":"1","origin-start":"1","start":"1"}},{"insert":"开通模型服务","attributes":{"hyperlink":"{\"href\":\"https://console.volcengine.com/ark/openManagement\",\"linkId\":\"gP3IIN8v1a\",\"newTab\":true}"}},{"insert":"\n"},{"insert":"*","attributes":{"lineId":"rzpkk0s184","list":"bullet1","lmkr":"1","origin-start":"1","start":"1"}},{"insert":"在 "},{"insert":"模型列表","attributes":{"hyperlink":"{\"href\":\"/docs/82379/1330310\",\"linkId\":\"e4VuM4aSSa\",\"newTab\":true}"}},{"insert":" 获取所需 Model ID\n"},{"insert":"*","attributes":{"lineId":"rzvdk0s2eb","list":"bullet2","lmkr":"1","origin-start":"1","start":"1"}},{"insert":"通过 Endpoint ID 调用模型服务，请参考 "},{"insert":"获取 Endpoint ID（创建自定义推理接入点）","attributes":{"hyperlink":"{\"href\":\"/docs/82379/1099522\",\"linkId\":\"AubMKCwQ4b\",\"newTab\":true}"}},{"insert":"。\n"},{"insert":"*","attributes":{"lineId":"rzyrh0s3s0","lmkr":"1"}},{"insert":"另外，使用 Knowledge Search 私域知识库搜索工具前，需完成 "},{"insert":"服务授权","attributes":{"bold":"true"}},{"insert":" 与 "},{"insert":"知识库准备","attributes":{"bold":"true"}},{"insert":" 两步操作，确保工具可正常访问私域数据：\n"},{"insert":"*","attributes":{"anchor":"#5c62cdd1","heading":"h3","lineId":"s01vc0s4m2","lmkr":"1"}},{"insert":"1. 服务授权","attributes":{"bold":"true"}},{"insert":"\n"},{"insert":"*","attributes":{"lineId":"s06b30s5th","lmkr":"1"}},{"insert":"需先为工具授予访问知识库的权限，支持两种授权方式：\n"},{"insert":"*","attributes":{"lineId":"s097g0s621","list":"bullet1","lmkr":"1","origin-start":"1","start":"1"}},{"insert":"项目授权（推荐）","attributes":{"bold":"true"}},{"insert":"\n"},{"insert":"*","attributes":{"lineId":"s0bse0s7wa","list":"bullet2","lmkr":"1","origin-start":"1","start":"1"}},{"insert":"当前支持以项目为维度快捷授权，登录 "},{"insert":"火山方舟控制台，","attributes":{"bold":"true"}},{"insert":"通过平台左上角切换项目。\n"},{"insert":"*","attributes":{"lineId":"s0fit0s8ll","list":"bullet2","lmkr":"1","origin-start":"1","start":"1"}},{"insert":"访问控制台 **项目配置 **页面，对当前项目下的知识库进行授权后，方舟服务可访问当前项目下所有知识库。\n"},{"insert":"*","attributes":{"lineId":"s0hnd0s9r0","list":"indent2","lmkr":"1","text-indent":"true"}},{"insert":" ","attributes":{"alt":"Image","image":"true","loadingStatus":"success","src":"https://p9-arcosite.byteimg.com/tos-cn-i-goo7wpa0wc/6b56c0b45c7446b28ac29ac4b7f2ec35~tplv-goo7wpa0wc-image.image","uuid":"M19LLTUd1J","width":"1484"}},{"insert":"\n"},{"insert":"*","attributes":{"lineId":"s0jxq0sar1","list":"bullet1","lmkr":"1","origin-start":"1","start":"1"}},{"insert":"IAM 授权","attributes":{"bold":"true"}},{"insert":"\n"},{"insert":"*","attributes":{"lineId":"s0nl30sbsh","list":"number2","lmkr":"1","origin-start":"1","start":"1"}},{"insert":"访问 "},{"insert":"权限策略-创建策略","attributes":{"hyperlink":"{\"href\":\"https://console.volcengine.com/iam/policymanage/policy/new\",\"linkId\":\"Jgqu4SdDTG\",\"newTab\":true}"}},{"insert":"，通过Json编辑器粘贴下面的内容并提交（注意替换账号AccountID）。\n"},{"insert":"*","attributes":{"lineId":"s0qj40scac","list":"indent1","lmkr":"1","text-indent":"true"}},{"insert":" ","attributes":{"language":"JSON","type":"codeblock","zoneId":"uusNvF7Q6y"}},{"insert":"\n"},{"insert":"*","attributes":{"lineId":"s0tps0sdi8","list":"indent1","lmkr":"1","text-indent":"true"}},{"insert":" ","attributes":{"alt":"Image","image":"true","loadingStatus":"success","src":"https://p9-arcosite.byteimg.com/tos-cn-i-goo7wpa0wc/0614d6dd1c5347f98c3a7db840d14aa3~tplv-goo7wpa0wc-image.image","uuid":"N9hC9O1mYr","width":"2916"}},{"insert":"\n"},{"insert":"*","attributes":{"lineId":"s0wag0sext","list":"indent1","lmkr":"1","text-indent":"true"}},{"insert":"2. 访问 "},{"insert":"角色管理","attributes":{"hyperlink":"{\"href\":\"https://console.volcengine.com/iam/identitymanage/role\",\"linkId\":\"DhI6HmOavZ\",\"newTab\":true}"}},{"insert":" 页面，新增角色，可以命名为 "},{"insert":"ArkAccessRole_项目名称","attributes":{"inlineCode":"true"}},{"insert":"，同时给角色赋予刚才创建的权限策略。\n"},{"insert":"*","attributes":{"anchor":"#1a9b1ddd","heading":"h3","lineId":"s0zga0sfps","lmkr":"1"}},{"insert":"2. 知识库准备","attributes":{"bold":"true"}},{"insert":"\n"},{"insert":"*","attributes":{"lineId":"s12kf0sga8","list":"bullet1","lmkr":"1","origin-start":"1","start":"1"}},{"insert":"需提前开通 "},{"insert":"旗舰版知识库","attributes":{"bold":"true"}},{"insert":"（标准版知识库暂不支持），并完成知识库构建与数据上传，操作指南详见 "},{"insert":"知识库构建文档","attributes":{"hyperlink":"{\"href\":\"https://www.volcengine.com/docs/82379/1261885\",\"linkId\":\"Y4DagXxaxy\",\"newTab\":true}"}},{"insert":"。\n"},{"insert":"*","attributes":{"lineId":"s172e0sh26","list":"bullet1","lmkr":"1","origin-start":"1","start":"1"}},{"insert":"计费说明：私域知识库搜索的收费标准详见 "},{"insert":"知识库计费文档","attributes":{"hyperlink":"{\"href\":\"https://www.volcengine.com/docs/82379/1263336\",\"linkId\":\"KBWozbFsUh\",\"newTab\":true}"}},{"insert":"。\n"},{"insert":"*","attributes":{"lineId":"s1bkd0sidy","list":"bullet1","lmkr":"1","origin-start":"1","start":"1"}},{"insert":"配额限制：知识库使用配额详见 "},{"insert":"知识库配额说明","attributes":{"hyperlink":"{\"href\":\"https://www.volcengine.com/docs/82379/1343907\",\"linkId\":\"yKXpLu2XDi\",\"newTab\":true}"}},{"insert":"，需确保配额充足以避免调用失败。\n"},{"insert":"*","attributes":{"anchor":"#a6673793","heading":"h2","lineId":"s1e0l0sjd9","lmkr":"1"}},{"insert":"快速开始","attributes":{"bold":"true"}},{"insert":"\n"},{"insert":"*","attributes":{"lineId":"s1h6f0skxe","lmkr":"1"}},{"insert":"以下提供多种调用方式示例，需先替换 "},{"insert":"\u003cARK_API_KEY\u003e","attributes":{"inlineCode":"true"}},{"insert":" 为实际密钥、"},{"insert":"\u003cknowledge_resource_id\u003e","attributes":{"inlineCode":"true"}},{"insert":" 为授权的知识库ID。\n"},{"insert":"*","attributes":{"lineId":"yqRe6Vz2","lmkr":"1"}},{"insert":" ","attributes":{"tabs":"true","tabsZoneId":"pENtgUXunF","zoneType":"Z"}},{"insert":"*","attributes":{"anchor":"#b0120dd9","heading":"h2","lineId":"s1j6i0slfk","lmkr":"1"}},{"insert":"参数说明","attributes":{"bold":"true"}},{"insert":"\n"},{"insert":"*","attributes":{"lineId":"s1n270sm0n","lmkr":"1"}},{"insert":"详情请参见 "},{"insert":"创建Responses模型请求","attributes":{"hyperlink":"{\"href\":\"https://www.volcengine.com/docs/82379/1569618\",\"linkId\":\"tUw7xINNLj\",\"newTab\":true}"}},{"insert":"。\n"},{"insert":"*","attributes":{"anchor":"#f9b9e3de","heading":"h2","lineId":"s1p670snha","lmkr":"1"}},{"insert":"支持模型列表","attributes":{"bold":"true"}},{"insert":"\n"},{"insert":"*","attributes":{"lineId":"s1r8i0soeg","lmkr":"1"}},{"insert":"Knowledge Search 工具支持的模型请参考"},{"insert":"私域知识库搜索工具","attributes":{"hyperlink":"{\"href\":\"/docs/82379/1330310#d89be1dc\",\"linkId\":\"hRsmRrKEKc\",\"newTab\":true}"}},{"insert":"。\n"},{"insert":"*","attributes":{"anchor":"#1570984c","heading":"h2","lineId":"s1tjp0sp2e","lmkr":"1"}},{"insert":"注意事项","attributes":{"bold":"true"}},{"insert":"\n"},{"insert":"*","attributes":{"lineId":"s39yl0sqg9","list":"number1","lmkr":"1","origin-start":"1","start":"1"}},{"insert":"【重要】计费与 Tokens 说明","attributes":{"bold":"true"}},{"insert":"：一轮搜索可能发起多个关键词并行查询，可通过返回参数 "},{"insert":"usage.tool_usage","attributes":{"inlineCode":"true"}},{"insert":" 和 "},{"insert":"usage.tool_usage_details","attributes":{"inlineCode":"true"}},{"insert":" 查看具体消耗情况。\n"},{"insert":"*","attributes":{"lineId":"s3c3y0srr9","list":"number1","lmkr":"1","origin-start":"2","start":"2"}},{"insert":"Function 命名冲突","attributes":{"bold":"true"}},{"insert":"：若用户自定义 Function 与 "},{"insert":"knowledge_search","attributes":{"inlineCode":"true"}},{"insert":" 重名，无需特殊配置，由模型根据问题场景自动判断调用哪个工具。\n"},{"insert":"*","attributes":{"lineId":"s3dxx0ss6e","list":"number1","lmkr":"1","origin-start":"3","start":"3"}},{"insert":"搜索改写限制","attributes":{"bold":"true"}},{"insert":"：当前暂不支持通过参数设置改写后问题的个数，需通过 "},{"insert":"system prompt","attributes":{"inlineCode":"true"}},{"insert":" 或 "},{"insert":"instructions","attributes":{"inlineCode":"true"}},{"insert":" 控制（例如要求“每次仅生成1个核心搜索关键词”）。\n"},{"insert":"*","attributes":{"lineId":"s3h4a0st8x","list":"number1","lmkr":"1","origin-start":"4","start":"4"}},{"insert":"知识库版本限制","attributes":{"bold":"true"}},{"insert":"：仅支持"},{"insert":"旗舰版知识库","attributes":{"bold":"true"}},{"insert":"，标准版知识库暂不支持。\n"},{"insert":"*","attributes":{"lineId":"s3jr70sugy","list":"number1","lmkr":"1","origin-start":"5","start":"5"}},{"insert":"错误信息","attributes":{"bold":"true"}},{"insert":"：暂不支持"},{"insert":"caching","attributes":{"inlineCode":"true"}},{"insert":" 参数，使用该参数会返回400错误信息。\n"},{"insert":"*","attributes":{"anchor":"#c9d3ed5d","heading":"h2","lineId":"s3lix0svfs","lmkr":"1"}},{"insert":"附：搜索模式系统提示词样例\n"},{"insert":" ","attributes":{"language":"Plain","type":"codeblock","zoneId":"jZufQHQ7ip"}},{"insert":"\n"},{"insert":"*","attributes":{"lineId":"H3Vyf9Bg","lmkr":"1"}},{"insert":"\n"}],"zoneId":"0","zoneType":"Z"},"BV4HyuhngO":{"ops":[{"insert":"*","attributes":{"lineId":"TCUCY4UN","lmkr":"1"}},{"insert":"curl --location 'https://ark.cn-beijing.volces.com/api/v3/responses' \\\\\n"},{"insert":"*","attributes":{"lineId":"bOCoPT1s","lmkr":"1"}},{"insert":"--header 'Content-Type: application/json' \\\\\n"},{"insert":"*","attributes":{"lineId":"aY4CwUoF","lmkr":"1"}},{"insert":"--header 'Authorization: Bearer \u003cARK_API_KEY\u003e' \\\\\n"},{"insert":"*","attributes":{"lineId":"ujRVfSU2","lmkr":"1"}},{"insert":"--header 'ark-beta-knowledge-search: true' \\\\\n"},{"insert":"*","attributes":{"lineId":"cytd572T","lmkr":"1"}},{"insert":"--data '{\n"},{"insert":"*","attributes":{"lineId":"pSZqaTw9","lmkr":"1"}},{"insert":"    \"model\": \"doubao-seed-1-6-251015\",\n"},{"insert":"*","attributes":{"lineId":"ouxrkGyg","lmkr":"1"}},{"insert":"    \"stream\": true,\n"},{"insert":"*","attributes":{"lineId":"t4HXrN2a","lmkr":"1"}},{"insert":"    \"thinking\": {\n"},{"insert":"*","attributes":{"lineId":"crOuDj0k","lmkr":"1"}},{"insert":"        \"type\": \"disabled\"  # 关闭模型思考，直接调用知识库搜索\n"},{"insert":"*","attributes":{"lineId":"W9T03VrK","lmkr":"1"}},{"insert":"    },\n"},{"insert":"*","attributes":{"lineId":"eou0E7Jj","lmkr":"1"}},{"insert":"    \"tools\": [\n"},{"insert":"*","attributes":{"lineId":"jutQDkdw","lmkr":"1"}},{"insert":"        {\n"},{"insert":"*","attributes":{"lineId":"75fPyg0Z","lmkr":"1"}},{"insert":"            \"type\": \"knowledge_search\",\n"},{"insert":"*","attributes":{"lineId":"wzInx8PU","lmkr":"1"}},{"insert":"            \"knowledge_resource_id\": \"\u003cknowledge_resource_id\u003e\",  # 替换为实际知识库ID\n"},{"insert":"*","attributes":{"lineId":"8ijvDda3","lmkr":"1"}},{"insert":"            \"limit\": 2,  # 最多返回2条搜索结果\n"},{"insert":"*","attributes":{"lineId":"blyj3ts7","lmkr":"1"}},{"insert":"            \"ranking_options\": {\n"},{"insert":"*","attributes":{"lineId":"X0Eeuwzr","lmkr":"1"}},{"insert":"                \"get_attachment_link\": true  # 获取图片临时下载链接\n"},{"insert":"*","attributes":{"lineId":"SsfT5glH","lmkr":"1"}},{"insert":"            }\n"},{"insert":"*","attributes":{"lineId":"uaFIKHZN","lmkr":"1"}},{"insert":"        }\n"},{"insert":"*","attributes":{"lineId":"MDMGoLio","lmkr":"1"}},{"insert":"    ],\n"},{"insert":"*","attributes":{"lineId":"0QMIVxxF","lmkr":"1"}},{"insert":"    \"input\": [\n"},{"insert":"*","attributes":{"lineId":"pf7BTL3S","lmkr":"1"}},{"insert":"        {\n"},{"insert":"*","attributes":{"lineId":"kLSn87yB","lmkr":"1"}},{"insert":"            \"role\": \"user\",\n"},{"insert":"*","attributes":{"lineId":"EKi74MBr","lmkr":"1"}},{"insert":"            \"content\": \"机票选择页面中，如何选择该航班不同价格的机票？\"  # 用户问题\n"},{"insert":"*","attributes":{"lineId":"nEMevCzz","lmkr":"1"}},{"insert":"        }\n"},{"insert":"*","attributes":{"lineId":"RC7R3bEf","lmkr":"1"}},{"insert":"    ],\n"},{"insert":"*","attributes":{"lineId":"YcXl5dNb","lmkr":"1"}},{"insert":"    \"max_tool_calls\": 1  # 仅调用1轮知识库搜索\n"},{"insert":"*","attributes":{"lineId":"hnXGJgTx","lmkr":"1"}},{"insert":"}'\n"}],"zoneId":"BV4HyuhngO","zoneType":"Z"},"FG2J6CFeGN":{"ops":[{"insert":" ","attributes":{"language":"Plain","type":"codeblock","zoneId":"BV4HyuhngO"}},{"insert":"\n"}],"zoneId":"FG2J6CFeGN","zoneType":"Z"},"HFCgBjVJaJ":{"ops":[{"insert":" ","attributes":{"language":"Python","type":"codeblock","zoneId":"crv9BcuDKe"}},{"insert":"\n"}],"zoneId":"HFCgBjVJaJ","zoneType":"Z"},"crv9BcuDKe":{"ops":[{"insert":"import","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" os\n"},{"insert":"from","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" openai "},{"insert":"import","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" OpenAI \n"},{"insert":"\n"},{"insert":"# 从环境变量获取API密钥，配置方法见：https://www.volcengine.com/docs/82379/1399008","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"\n"},{"insert":"api_key = os.getenv("},{"insert":"'ARK_API_KEY'","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":")\n"},{"insert":"\n"},{"insert":"# 初始化客户端","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"\n"},{"insert":"client = OpenAI(\n"},{"insert":"    base_url="},{"insert":"'https://ark.cn-beijing.volces.com/api/v3'","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":",\n"},{"insert":"    api_key=api_key,\n"},{"insert":"    default_headers={"},{"insert":"\"ark-beta-knowledge-search\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":": "},{"insert":"\"true\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"}  "},{"insert":"# 启用私域知识库搜索","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"\n"},{"insert":")\n"},{"insert":"\n"},{"insert":"# 发起知识库搜索请求","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"\n"},{"insert":"response = client.responses.create(\n"},{"insert":"    model="},{"insert":"\"doubao-seed-1-6-251015\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":",  "},{"insert":"# 替换为支持的模型","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"\n"},{"insert":"    "},{"insert":"input","attributes":{"clientside-highlight":"code-hljs-built_in"}},{"insert":"=[\n"},{"insert":"        {\n"},{"insert":"            "},{"insert":"\"role\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":": "},{"insert":"\"user\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":",\n"},{"insert":"            "},{"insert":"\"content\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":": [\n"},{"insert":"                {\n"},{"insert":"                    "},{"insert":"\"type\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":": "},{"insert":"\"input_text\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":",\n"},{"insert":"                    "},{"insert":"\"text\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":": "},{"insert":"\"应用实验室里有类似实时视频理解的agent demo么？\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"  "},{"insert":"# 用户问题","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"\n"},{"insert":"                }\n"},{"insert":"            ]\n"},{"insert":"        }\n"},{"insert":"    ],\n"},{"insert":"    tools=[\n"},{"insert":"        {\n"},{"insert":"            "},{"insert":"\"type\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":": "},{"insert":"\"knowledge_search\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":",\n"},{"insert":"            "},{"insert":"\"knowledge_resource_id\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":": "},{"insert":"\"\u003cknowledge_resource_id\u003e\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":",  "},{"insert":"# 替换为实际知识库ID","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"\n"},{"insert":"            "},{"insert":"\"limit\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":": "},{"insert":"10","attributes":{"clientside-highlight":"code-hljs-number"}},{"insert":",  "},{"insert":"# 最多返回10条搜索结果","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"\n"},{"insert":"        }\n"},{"insert":"    ],\n"},{"insert":"    stream="},{"insert":"True","attributes":{"clientside-highlight":"code-hljs-literal"}},{"insert":",  "},{"insert":"# 启用流式响应，实时获取结果","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"\n"},{"insert":"    extra_body={"},{"insert":"\"thinking\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":": {"},{"insert":"\"type\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":": "},{"insert":"\"auto\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"}}  "},{"insert":"# 模型自动判断是否需要搜索","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"\n"},{"insert":")\n"},{"insert":"\n"},{"insert":"# 处理流式响应","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"\n"},{"insert":"for","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" chunk "},{"insert":"in","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" response:\n"},{"insert":"    "},{"insert":"if","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" "},{"insert":"hasattr","attributes":{"clientside-highlight":"code-hljs-built_in"}},{"insert":"(chunk, "},{"insert":"'delta'","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"):\n"},{"insert":"        "},{"insert":"print","attributes":{"clientside-highlight":"code-hljs-built_in"}},{"insert":"(chunk.delta, end="},{"insert":"\"\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":", flush="},{"insert":"True","attributes":{"clientside-highlight":"code-hljs-literal"}},{"insert":")\n"}],"zoneId":"crv9BcuDKe","zoneType":"Z"},"jZufQHQ7ip":{"ops":[{"insert":"*","attributes":{"lineId":"nr38CT39","lmkr":"1"}},{"insert":"# 定义系统提示词\n"},{"insert":"*","attributes":{"lineId":"SrS9rNvQ","lmkr":"1"}},{"insert":"system_prompt = \"\"\"\n"},{"insert":"*","attributes":{"lineId":"gtGdH3Ih","lmkr":"1"}},{"insert":"你是豆包个人助手，负责解答用户的各种问题。你的主要职责是：\n"},{"insert":"*","attributes":{"lineId":"2Aw8KBev","lmkr":"1"}},{"insert":"1. **信息准确性守护者**：确保提供的信息准确无误。\n"},{"insert":"*","attributes":{"lineId":"263w72v0","lmkr":"1"}},{"insert":"2. **搜索成本优化师**：在信息准确性和搜索成本之间找到最佳平衡。\n"},{"insert":"*","attributes":{"lineId":"mfmqywUg","lmkr":"1"}},{"insert":"# 任务说明\n"},{"insert":"*","attributes":{"lineId":"Qa41Qn4N","lmkr":"1"}},{"insert":"## 1. 知识库意图判断\n"},{"insert":"*","attributes":{"lineId":"cmXGzhRE","lmkr":"1"}},{"insert":"当用户提出的问题涉及以下情况时，需使用 `knowledge_search` 进行私域知识搜索：\n"},{"insert":"*","attributes":{"lineId":"Lqgpw9JP","lmkr":"1"}},{"insert":"- **企业知识**：问题有关于火山方舟、大模型、responses API\n"},{"insert":"*","attributes":{"lineId":"Buoqf2Ba","lmkr":"1"}},{"insert":"## 2. 知识库搜索后回答\n"},{"insert":"*","attributes":{"lineId":"jfHx4LxF","lmkr":"1"}},{"insert":"- 在回答中，优先使用已搜索到的资料。\n"},{"insert":"*","attributes":{"lineId":"Uv4OGbuM","lmkr":"1"}},{"insert":"- 回复结构应清晰，使用序号、分段等方式帮助用户理解。\n"},{"insert":"*","attributes":{"lineId":"QcMhPrq4","lmkr":"1"}},{"insert":"## 3. 引用已搜索资料\n"},{"insert":"*","attributes":{"lineId":"aeB4alfJ","lmkr":"1"}},{"insert":"- 当使用知识库搜索的资料时，在正文中明确引用来源，引用格式为：  \n"},{"insert":"*","attributes":{"lineId":"k0CrKmzJ","lmkr":"1"}},{"insert":"`[1]  (URL地址)`。\n"},{"insert":"*","attributes":{"lineId":"fiZ675C1","lmkr":"1"}},{"insert":"## 4. 总结与参考资料\n"},{"insert":"*","attributes":{"lineId":"zBTLBxJ0","lmkr":"1"}},{"insert":"- 在回复的最后，列出所有已参考的资料。格式为：  \n"},{"insert":"*","attributes":{"lineId":"t2V4nUCY","lmkr":"1"}},{"insert":"1. [资料标题](URL地址1)\n"},{"insert":"*","attributes":{"lineId":"LIi0EKu5","lmkr":"1"}},{"insert":"2. [资料标题](URL地址2)\n"},{"insert":"*","attributes":{"lineId":"0k4cljiO","lmkr":"1"}},{"insert":"\"\"\"\n"}],"zoneId":"jZufQHQ7ip","zoneType":"Z"},"pENtgUXunF":{"ops":[{"insert":" ","attributes":{"tabContent":"true","title":"Curl","zoneId":"FG2J6CFeGN"}},{"insert":" ","attributes":{"tabContent":"true","title":"OpenAI SDK","zoneId":"HFCgBjVJaJ"}},{"insert":"\n"}],"zoneId":"pENtgUXunF","zoneType":"Z"},"uusNvF7Q6y":{"ops":[{"insert":"*","attributes":{"lineId":"YN20E8dW","lmkr":"1"}},{"insert":"{","attributes":{"clientside-highlight":"code-hljs-punctuation"}},{"insert":"\n"},{"insert":"*","attributes":{"lineId":"QnU39fPg","lmkr":"1"}},{"insert":" "},{"insert":" \"Statement\"","attributes":{"clientside-highlight":"code-hljs-attr"}},{"insert":": [","attributes":{"clientside-highlight":"code-hljs-punctuation"}},{"insert":"\n"},{"insert":"*","attributes":{"lineId":"ufFT2TTI","lmkr":"1"}},{"insert":"  "},{"insert":"  {","attributes":{"clientside-highlight":"code-hljs-punctuation"}},{"insert":"\n"},{"insert":"*","attributes":{"lineId":"rnKK35vD","lmkr":"1"}},{"insert":"   "},{"insert":"   \"Effect\"","attributes":{"clientside-highlight":"code-hljs-attr"}},{"insert":":","attributes":{"clientside-highlight":"code-hljs-punctuation"}},{"insert":" \"Allow\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":",","attributes":{"clientside-highlight":"code-hljs-punctuation"}},{"insert":"\n"},{"insert":"*","attributes":{"lineId":"fOBEmZPO","lmkr":"1"}},{"insert":"  "},{"insert":"    \"Action\"","attributes":{"clientside-highlight":"code-hljs-attr"}},{"insert":": [","attributes":{"clientside-highlight":"code-hljs-punctuation"}},{"insert":"\n"},{"insert":"*","attributes":{"lineId":"Zd5W5j2o","lmkr":"1"}},{"insert":"   "},{"insert":"     \"vikingdb:*\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"\n"},{"insert":"*","attributes":{"lineId":"RnUSSomF","lmkr":"1"}},{"insert":"      ],","attributes":{"clientside-highlight":"code-hljs-punctuation"}},{"insert":"\n"},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-attr","lineId":"8gOXD6Ra","lmkr":"1"}},{"insert":"      \"Resource\"","attributes":{"clientside-highlight":"code-hljs-attr"}},{"insert":": [","attributes":{"clientside-highlight":"code-hljs-punctuation"}},{"insert":"\n"},{"insert":"*","attributes":{"lineId":"UEK8nwaP","lmkr":"1"}},{"insert":"        \"trn:ark:*:账号AccountID:knowledgebase/*\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":",\n","attributes":{"clientside-highlight":"code-hljs-punctuation"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-punctuation","lineId":"duK6kMfc","lmkr":"1"}},{"insert":"      ]\n","attributes":{"clientside-highlight":"code-hljs-punctuation"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-punctuation","lineId":"nIPoJtxv","lmkr":"1"}},{"insert":"    }\n","attributes":{"clientside-highlight":"code-hljs-punctuation"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-punctuation","lineId":"f7ytSN0x","lmkr":"1"}},{"insert":"  ]\n","attributes":{"clientside-highlight":"code-hljs-punctuation"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-punctuation","lineId":"dWviaHBc","lmkr":"1"}},{"insert":"}","attributes":{"clientside-highlight":"code-hljs-punctuation"}},{"insert":"\n"}],"zoneId":"uusNvF7Q6y","zoneType":"Z"}}}
