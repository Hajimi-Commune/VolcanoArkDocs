# 云部署 MCP / Remote MCP
{"version":"1.2.31","data":{"0":{"ops":[{"insert":"*","attributes":{"anchor":"#e2bd9c96","heading":"h2","lineId":"mno2k0rsvc","lmkr":"1"}},{"insert":"核心功能","attributes":{"bold":"true"}},{"insert":"\n"},{"insert":"*","attributes":{"lineId":"mnvku0rtcf","list":"bullet1","lmkr":"1","origin-start":"1","start":"1"}},{"insert":"丰富MCP生态兼容：对接“"},{"insert":"MCP MarketPlace","attributes":{"hyperlink":"{\"href\":\"https://www.volcengine.com/mcp-marketplace\",\"linkId\":\"x4azHQeQJ9\",\"newTab\":true}"}},{"insert":"”，支持调用市场内各类垂直领域MCP工具（如巨量千川、知识库），无需自行开发工具逻辑。\n"},{"insert":"*","attributes":{"lineId":"mnzln0rukl","list":"bullet1","lmkr":"1","origin-start":"1","start":"1"}},{"insert":"多轮工具调用：复杂任务（如多步数据查询+分析）支持多轮MCP调用，上一轮工具输出结果自动作为下一轮模型输入（例：MCP数据查询→模型分析→二次补充查询）。\n"},{"insert":"*","attributes":{"lineId":"mo1d90rvcp","list":"bullet1","lmkr":"1","origin-start":"1","start":"1"}},{"insert":"灵活混合调用：可与用户自定义Function、Web Search工具混合使用（如联合巨量千川MCP与Web Search实现“数据+热点”交叉分析），暂不限制工具组合数量。\n"},{"insert":"*","attributes":{"lineId":"mo3ah0rwo3","lmkr":"1","tips":"{\"type\":\"tip\",\"isTitle\":true}"}},{"insert":"说明\n"},{"insert":"*","attributes":{"lineId":"mo5a20rxz3","lmkr":"1","tips":"{\"type\":\"tip\"}"}},{"insert":"测试期间调用此工具需要增加 header '"},{"insert":"ark-beta-mcp: true","attributes":{"inlineCode":"true"}},{"insert":"'，调用方式请参见"},{"insert":"快速开始","attributes":{"hyperlink":"{\"href\":\"/docs/82379/1827534#d20c754a\",\"linkId\":\"mZbq7wSwKY\",\"newTab\":true}"}},{"insert":"。\n"},{"insert":"*","attributes":{"anchor":"#2541e18e","heading":"h2","lineId":"mo7oa0rykc","lmkr":"1"}},{"insert":"前提条件\n"},{"insert":"*","attributes":{"lineId":"moa5p0rz3r","list":"bullet1","lmkr":"1","origin-start":"1","start":"1"}},{"insert":"获取 API Key","attributes":{"hyperlink":"{\"href\":\"https://console.volcengine.com/ark/region:ark+cn-beijing/apiKey\",\"linkId\":\"nKsolI4Vml\",\"newTab\":true}"}},{"insert":"\n"},{"insert":"*","attributes":{"lineId":"mod8h0s0ud","list":"bullet1","lmkr":"1","origin-start":"1","start":"1"}},{"insert":"开通模型服务","attributes":{"hyperlink":"{\"href\":\"https://console.volcengine.com/ark/openManagement\",\"linkId\":\"ICNnYSGLwY\",\"newTab\":true}"}},{"insert":"\n"},{"insert":"*","attributes":{"lineId":"mofrb0s1ea","list":"bullet1","lmkr":"1","origin-start":"1","start":"1"}},{"insert":"在 "},{"insert":"模型列表","attributes":{"hyperlink":"{\"href\":\"/docs/82379/1330310\",\"linkId\":\"VnsBExJ9pw\",\"newTab\":true}"}},{"insert":" 获取所需 Model ID\n"},{"insert":"*","attributes":{"lineId":"moi8h0s2yb","list":"bullet2","lmkr":"1","origin-start":"1","start":"1"}},{"insert":"通过 Endpoint ID 调用模型服务，请参考 "},{"insert":"获取 Endpoint ID（创建自定义推理接入点）","attributes":{"hyperlink":"{\"href\":\"/docs/82379/1099522\",\"linkId\":\"hj4jgoJQPB\",\"newTab\":true}"}},{"insert":"。\n"},{"insert":"*","attributes":{"anchor":"#d20c754a","heading":"h2","lineId":"mokle0s3o4","lmkr":"1"}},{"insert":"快速入门","attributes":{"bold":"true"}},{"insert":"\n"},{"insert":"*","attributes":{"lineId":"mom7v0s44z","lmkr":"1"}},{"insert":"以下提供两种常用调用场景示例，需先替换 "},{"insert":"\u003cARK_API_KEY\u003e","attributes":{"inlineCode":"true"}},{"insert":" 为实际密钥，"},{"insert":"server_label","attributes":{"inlineCode":"true"}},{"insert":"/"},{"insert":"server_url","attributes":{"inlineCode":"true"}},{"insert":" 为实际MCP Server 信息。\n"},{"insert":"*","attributes":{"anchor":"#3601f0fd","heading":"h3","lineId":"moq5q0s5vz","lmkr":"1"}},{"insert":"获取 MCP URL\n"},{"insert":"*","attributes":{"lineId":"morx20s6a1","lmkr":"1"}},{"insert":"您可以访问 "},{"insert":"MCP MarketPlace","attributes":{"hyperlink":"{\"href\":\"https://www.volcengine.com/mcp-marketplace\",\"linkId\":\"Vm5s6OaHr6\",\"newTab\":true}"}},{"insert":"，选择想要使用的云部署 MCP / Remote MCP。\n"},{"insert":"*","attributes":{"lineId":"mou060s7r5","lmkr":"1"}},{"insert":" ","attributes":{"alt":"Image","image":"true","loadingStatus":"success","src":"https://p9-arcosite.byteimg.com/tos-cn-i-goo7wpa0wc/4b1779c885354816878ca958a3268e1e~tplv-goo7wpa0wc-image.image","uuid":"pTs8aOe96h","width":"1283"}},{"insert":"\n"},{"insert":"*","attributes":{"lineId":"mow4l0s8la","lmkr":"1"}},{"insert":"在 MCP 详情页，点击生成获取带授权的个人 MCP 服务端URL。\n"},{"insert":"*","attributes":{"blockquote":"true","lineId":"mp0h00s9fp","lmkr":"1","wrapperIndent":"0"}},{"insert":"部分 MCP 通过"},{"insert":"Authorization","attributes":{"inlineCode":"true"}},{"insert":"字段来配置授权，详情请参考"},{"insert":"2. 配置鉴权信息","attributes":{"hyperlink":"{\"href\":\"/docs/82379/1827534#8cf42728\",\"linkId\":\"xTtrqQmdLa\",\"newTab\":true}"}},{"insert":"。\n"},{"insert":"*","attributes":{"lineId":"mp3cz0sa9y","lmkr":"1"}},{"insert":" ","attributes":{"alt":"Image","image":"true","loadingStatus":"success","src":"https://p9-arcosite.byteimg.com/tos-cn-i-goo7wpa0wc/c85a81f998b24194a89d343a84576c0a~tplv-goo7wpa0wc-image.image","uuid":"Pe5N2WVJcI","width":"1253"}},{"insert":"\n"},{"insert":"*","attributes":{"anchor":"#d1f41fc9","heading":"h3","lineId":"mp5dk0sbot","lmkr":"1"}},{"insert":"快速开始\n"},{"insert":"*","attributes":{"lineId":"uU5pYLvM","lmkr":"1"}},{"insert":" ","attributes":{"tabs":"true","tabsZoneId":"oW0ppPsl2y","zoneType":"Z"}},{"insert":"*","attributes":{"anchor":"#6d3a96c1","heading":"h2","lineId":"mp7tf0sct0","lmkr":"1"}},{"insert":"参数说明","attributes":{"bold":"true"}},{"insert":"\n"},{"insert":"*","attributes":{"lineId":"mp9rl0sdif","lmkr":"1"}},{"insert":"详情请参见 "},{"insert":"创建Responses模型请求","attributes":{"hyperlink":"{\"href\":\"https://www.volcengine.com/docs/82379/1569618\",\"linkId\":\"m9ugDO7ODz\",\"newTab\":true}"}},{"insert":"。\n"},{"insert":"*","attributes":{"anchor":"#14044090","heading":"h2","lineId":"mpbk60se54","lmkr":"1"}},{"insert":"支持模型列表","attributes":{"bold":"true"}},{"insert":"\n"},{"insert":"*","attributes":{"lineId":"mpdqc0sf07","lmkr":"1"}},{"insert":"参见"},{"insert":"MCP 调用能力","attributes":{"hyperlink":"{\"href\":\"/docs/82379/1330310#f449e5cb\",\"linkId\":\"eQIlE1x8dG\",\"newTab\":true}"}},{"insert":"。\n"},{"insert":"*","attributes":{"blockquote":"true","lineId":"mpg000sgxj","lmkr":"1","wrapperIndent":"0"}},{"insert":"模型调用需确保已完成MCP服务开通及对应模型权限申请，未开通用户无法触发MCP工具功能。\n"},{"insert":"*","attributes":{"anchor":"#3e032fac","heading":"h2","lineId":"mpikb0shmr","lmkr":"1"}},{"insert":"使用指南\n"},{"insert":"*","attributes":{"lineId":"mpkyn0si72","lmkr":"1"}},{"insert":"本节介绍了常见的使用场景及其字段设置方法，以帮助您更高效地运用 MCP 工具。\n"},{"insert":"*","attributes":{"anchor":"#4a0539e7","heading":"h3","lineId":"mpnjt0sjxm","lmkr":"1"}},{"insert":"1. 过滤 MCP 工具\n"},{"insert":"*","attributes":{"lineId":"mppte0sksr","lmkr":"1"}},{"insert":"一个 MCP 服务器可能提供多种工具。您可以在该服务的详情页查看完整的工具列表。在 API 调用时，您可以使用 "},{"insert":"allowed_tools","attributes":{"inlineCode":"true"}},{"insert":" 参数来指定要使用的工具，从而节省时间并获得更符合预期的结果。\n"},{"insert":" ","attributes":{"language":"Python","type":"codeblock","zoneId":"wZ1Ou3CiVO"}},{"insert":"\n"},{"insert":"*","attributes":{"anchor":"#8cf42728","heading":"h3","lineId":"mpsdt0slth","lmkr":"1"}},{"insert":"2. 配置鉴权信息\n"},{"insert":"*","attributes":{"lineId":"mpv2t0smv5","lmkr":"1"}},{"insert":"目前部分 MCP 工具需要在header中配置身份验证。一般通过"},{"insert":"Authorization","attributes":{"inlineCode":"true"}},{"insert":"字段来配置，示例参考如下：\n"},{"insert":" ","attributes":{"language":"Bash","type":"codeblock","zoneId":"MRzMBYtlMc"}},{"insert":"\n"},{"insert":"*","attributes":{"anchor":"#32684885","heading":"h2","lineId":"mpx5z0snv8","lmkr":"1"}},{"insert":"最佳实践","attributes":{"bold":"true"}},{"insert":"\n"},{"insert":"*","attributes":{"anchor":"#599486b3","heading":"h3","lineId":"mpz510sos6","lmkr":"1"}},{"insert":"多轮调用示例","attributes":{"bold":"true"}},{"insert":"\n"},{"insert":"*","attributes":{"lineId":"mq1wm0sppz","lmkr":"1"}},{"insert":"场景","attributes":{"bold":"true"}},{"insert":"：调用巨量千川MCP分析直播数据，需用户确认后执行，支持多轮补充查询。\n"},{"insert":"*","attributes":{"lineId":"REhVipua","lmkr":"1"}},{"insert":" ","attributes":{"tabs":"true","tabsZoneId":"PCOLJjKgum","zoneType":"Z"}},{"insert":"*","attributes":{"anchor":"#ed72f0d8","heading":"h2","lineId":"mq4d80sqpr","lmkr":"1"}},{"insert":"注意事项","attributes":{"bold":"true"}},{"insert":"\n"},{"insert":"*","attributes":{"lineId":"mq6p30srmc","list":"number1","lmkr":"1","origin-start":"1","start":"1"}},{"insert":"目前云部署 MCP / Remote MCP 仅支持通过 Responses API 调用，同时"},{"insert":"只支持通过 Streamable HTTP 链接的 MCP","attributes":{"bold":"true"}},{"insert":"。\n"},{"insert":"*","attributes":{"lineId":"mq92b0ss3g","list":"number1","lmkr":"1","origin-start":"2","start":"2"}},{"insert":"Function命名冲突","attributes":{"bold":"true"}},{"insert":"：若用户自定义 Function 与 MCP 内置工具（如"},{"insert":"mcp_call","attributes":{"inlineCode":"true"}},{"insert":"）重名，由模型自动判断调用优先级，无需额外配置。\n"},{"insert":"*","attributes":{"lineId":"mqbib0stf4","list":"number1","lmkr":"1","origin-start":"3","start":"3"}},{"insert":"默认限流规则","attributes":{"bold":"true"}},{"insert":"：账号维度默认限流为"},{"insert":"1000 RPM","attributes":{"inlineCode":"true"}},{"insert":"（每分钟请求数），超出限流将导致请求失败，需调整可提交工单。\n"},{"insert":"*","attributes":{"lineId":"mqd8g0suvz","list":"number1","lmkr":"1","origin-start":"4","start":"4"}},{"insert":"错误信息","attributes":{"bold":"true"}},{"insert":"：暂不支持"},{"insert":"caching","attributes":{"inlineCode":"true"}},{"insert":" 参数，使用该参数会返回400错误信息。\n"},{"insert":"*","attributes":{"anchor":"#7cb69a7a","heading":"h2","lineId":"mqfuo0sv6s","lmkr":"1"}},{"insert":"计费说明","attributes":{"bold":"true"}},{"insert":"\n"},{"insert":"*","attributes":{"lineId":"mqhg30swum","lmkr":"1"}},{"insert":"消耗模型基础Tokens，不收取MCP工具调用附加费。\n"},{"insert":"*","attributes":{"anchor":"#54e38873","heading":"h2","lineId":"mqj1c0sxem","lmkr":"1"}},{"insert":"相关参考\n"},{"insert":"*","attributes":{"lineId":"mqll90sysf","list":"bullet1","lmkr":"1","origin-start":"1","start":"1"}},{"insert":"Responses API："},{"insert":"创建Responses模型请求","attributes":{"hyperlink":"{\"href\":\"https://www.volcengine.com/docs/82379/1569618\",\"linkId\":\"kKET7g9Ppr\",\"newTab\":true}"}},{"insert":"\n"},{"insert":"*","attributes":{"lineId":"mqn6r0sz83","list":"bullet1","lmkr":"1","origin-start":"1","start":"1"}},{"insert":"联网搜索 Web Search","attributes":{"hyperlink":"{\"href\":\"/docs/82379/1756990\",\"linkId\":\"SOLtxk4yNv\",\"newTab\":true}"}},{"insert":"\n"},{"insert":"*","attributes":{"lineId":"mqoyb0t0f1","list":"bullet1","lmkr":"1","origin-start":"1","start":"1"}},{"insert":"MCP MarketPlace","attributes":{"hyperlink":"{\"href\":\"https://www.volcengine.com/mcp-marketplace\",\"linkId\":\"yROjfw8qdF\",\"newTab\":true}"}},{"insert":"\n"},{"insert":"*","attributes":{"lineId":"HFv8ZcOl","lmkr":"1"}},{"insert":"\n"}],"zoneId":"0","zoneType":"Z"},"DJtpAVdShi":{"ops":[{"insert":"*","attributes":{"lineId":"4SqEfjNy","lmkr":"1"}},{"insert":"from","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" volcenginesdkarkruntime "},{"insert":"import","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" Ark\n"},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-keyword","lineId":"aTDDQUdy","lmkr":"1"}},{"insert":"import","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" os\n"},{"insert":"*","attributes":{"lineId":"HQtw7GyP","lmkr":"1"}},{"insert":"\n"},{"insert":"*","attributes":{"lineId":"XqhSS1LD","lmkr":"1"}},{"insert":"api_key = os.gete"},{"insert":"nv('ARK_API_KEY'","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":")\n"},{"insert":"*","attributes":{"lineId":"UALhvyyp","lmkr":"1"}},{"insert":"client = Ark(\n"},{"insert":"*","attributes":{"lineId":"9uiNk8pq","lmkr":"1"}},{"insert":"    base"},{"insert":"_url='https://ark.cn-beijing.volces.com/api/v3'","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":",\n"},{"insert":"*","attributes":{"lineId":"66wcYwFp","lmkr":"1"}},{"insert":"    api_key=api_k"},{"insert":"ey\n","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-comment","lineId":"bTRscSaP","lmkr":"1"}},{"insert":")\n","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-comment","lineId":"n28j0a2N","lmkr":"1"}},{"insert":"\n","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-comment","lineId":"QF8azFV0","lmkr":"1"}},{"insert":"# 1. 首轮请求：发起MCP调用审批","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"\n"},{"insert":"*","attributes":{"lineId":"ZbaRSn6r","lmkr":"1"}},{"insert":"first_response = client.responses.create(\n"},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-string","lineId":"mLs3tlDB","lmkr":"1"}},{"insert":"    model=\"doubao-seed-1-6-251015\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":",\n"},{"insert":"*","attributes":{"lineId":"ooxTE3kw","lmkr":"1"}},{"insert":"    tools=[\n"},{"insert":"*","attributes":{"lineId":"50yG2wrz","lmkr":"1"}},{"insert":"        {"},{"insert":"\n","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-string","lineId":"2rAQNdDu","lmkr":"1"}},{"insert":"            \"type\": \"mcp\",\n","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-string","lineId":"iXga9MMD","lmkr":"1"}},{"insert":"            \"server_label\": \"qianchuan-mcp\",\n","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-string","lineId":"cJ0MD8uD","lmkr":"1"}},{"insert":"            \"server_url\": \"https://mcp.qianchuan.com/mcp\",\n","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-string","lineId":"Sd49zksU","lmkr":"1"}},{"insert":"            \"require_approval\": \"always\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"\n"},{"insert":"*","attributes":{"lineId":"W7bEWCpy","lmkr":"1"}},{"insert":"   "},{"insert":"     }\n","attributes":{"clientside-highlight":"code-hljs-built_in"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-built_in","lineId":"OLy48STz","lmkr":"1"}},{"insert":"    ],\n","attributes":{"clientside-highlight":"code-hljs-built_in"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-built_in","lineId":"jFaTjjbI","lmkr":"1"}},{"insert":"    input","attributes":{"clientside-highlight":"code-hljs-built_in"}},{"insert":"=[\n"},{"insert":"*","attributes":{"lineId":"8zq9iP0z","lmkr":"1"}},{"insert":" "},{"insert":"       {\n","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-string","lineId":"hAy70mc1","lmkr":"1"}},{"insert":"            \"role\": \"user\",\n","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-string","lineId":"BeVJLUnJ","lmkr":"1"}},{"insert":"            \"content\": [{\"type\": \"input_text\", \"text\": \"分析今日直播间竞价推广数据\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"}]\n"},{"insert":"*","attributes":{"lineId":"hdVkPbn8","lmkr":"1"}},{"insert":"        }\n"},{"insert":"*","attributes":{"lineId":"XeEfg6OS","lmkr":"1"}},{"insert":" "},{"insert":"   ],\n","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-string","lineId":"MUR9gBF5","lmkr":"1"}},{"insert":"    extra_headers={\"ark-beta-mcp\": \"true\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"},\n","attributes":{"clientside-highlight":"code-hljs-literal"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-literal","lineId":"AzByosTa","lmkr":"1"}},{"insert":"    stream=True","attributes":{"clientside-highlight":"code-hljs-literal"}},{"insert":"\n","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-comment","lineId":"rs2IGKwX","lmkr":"1"}},{"insert":")\n","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-comment","lineId":"LBKFVcQr","lmkr":"1"}},{"insert":"\n","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-comment","lineId":"POPGSonL","lmkr":"1"}},{"insert":"# 提取审批ID与上一轮响应ID","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"\n","attributes":{"clientside-highlight":"code-hljs-literal"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-literal","lineId":"yLgNne1s","lmkr":"1"}},{"insert":"last_chunk = None","attributes":{"clientside-highlight":"code-hljs-literal"}},{"insert":"\n","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-keyword","lineId":"MqOjwEnN","lmkr":"1"}},{"insert":"for chunk in","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" first_response:\n"},{"insert":"*","attributes":{"lineId":"Zbl08Hjh","lmkr":"1"}},{"insert":"    last_chunk = chunk\n"},{"insert":"*","attributes":{"lineId":"rdpHrxNm","lmkr":"1"}},{"insert":"previous_"},{"insert":"response_id = last_chunk.response.id","attributes":{"clientside-highlight":"code-hljs-built_in"}},{"insert":"\n"},{"insert":"*","attributes":{"lineId":"gehh7C4g","lmkr":"1"}},{"insert":"approva"},{"insert":"l_id = last_chunk.response.output[-1","attributes":{"clientside-highlight":"code-hljs-number"}},{"insert":"].id\n","attributes":{"clientside-highlight":"code-hljs-built_in"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-built_in","lineId":"TSWZ2Ckv","lmkr":"1"}},{"insert":"print","attributes":{"clientside-highlight":"code-hljs-built_in"}},{"insert":"(f\"上一轮响应ID：","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"{previous_response_id}","attributes":{"clientside-highlight":"code-hljs-subst"}},{"insert":"，审批ID：","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"{approval_id}","attributes":{"clientside-highlight":"code-hljs-subst"}},{"insert":"\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":")\n","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-comment","lineId":"TBtBoG1y","lmkr":"1"}},{"insert":"\n","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-comment","lineId":"iqBNzeOI","lmkr":"1"}},{"insert":"# 2. 二轮请求：同意审批并继续执行","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"\n"},{"insert":"*","attributes":{"lineId":"H6dxmysQ","lmkr":"1"}},{"insert":"second_respons"},{"insert":"e = client.responses.create(\n","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-string","lineId":"tRpN5IXv","lmkr":"1"}},{"insert":"    model=\"doubao-seed-1-6-251015\",\n","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-string","lineId":"LYMYBZr5","lmkr":"1"}},{"insert":"    tools=[\n","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-string","lineId":"942QePKz","lmkr":"1"}},{"insert":"        {\n","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-string","lineId":"wCw2MGAl","lmkr":"1"}},{"insert":"            \"type\": \"mcp\",\n","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-string","lineId":"aRwHKlQ2","lmkr":"1"}},{"insert":"            \"server_label\": \"qianchuan-mcp\",\n","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-string","lineId":"njDsizsR","lmkr":"1"}},{"insert":"            \"server_url\": \"https://mcp.qianchuan.com/mcp\",\n","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-string","lineId":"haDtXP8F","lmkr":"1"}},{"insert":"            \"require_approval\": \"always\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"\n","attributes":{"clientside-highlight":"code-hljs-built_in"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-built_in","lineId":"mzrmIybr","lmkr":"1"}},{"insert":"        }\n","attributes":{"clientside-highlight":"code-hljs-built_in"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-built_in","lineId":"TADVNgVW","lmkr":"1"}},{"insert":"    ],\n","attributes":{"clientside-highlight":"code-hljs-built_in"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-built_in","lineId":"ifwD9P9f","lmkr":"1"}},{"insert":"    input","attributes":{"clientside-highlight":"code-hljs-built_in"}},{"insert":"=[\n","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-string","lineId":"SsVtS9U3","lmkr":"1"}},{"insert":"        {\n","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-string","lineId":"05GyCYW2","lmkr":"1"}},{"insert":"            \"type\": \"mcp_approval_response\",\n","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-string","lineId":"yqM1mQ98","lmkr":"1"}},{"insert":"            \"approve\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":": True","attributes":{"clientside-highlight":"code-hljs-literal"}},{"insert":",  # 同意审批","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"\n","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-string","lineId":"rxsdbNBa","lmkr":"1"}},{"insert":"            \"approval_request_id\": approval_id\n","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-string","lineId":"lBveFXKl","lmkr":"1"}},{"insert":"        }\n","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-string","lineId":"cIEp29FB","lmkr":"1"}},{"insert":"    ],\n","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-string","lineId":"c8eUEUwZ","lmkr":"1"}},{"insert":"    extra_headers={\"ark-beta-mcp\": \"true\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"},\n","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-comment","lineId":"FHOkkiOC","lmkr":"1"}},{"insert":"    previous_response_id=previous_response_id,  # 关联上一轮请求","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"\n","attributes":{"clientside-highlight":"code-hljs-literal"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-literal","lineId":"4kr8f2GX","lmkr":"1"}},{"insert":"    stream=True","attributes":{"clientside-highlight":"code-hljs-literal"}},{"insert":"\n","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-comment","lineId":"ky2Qi0dr","lmkr":"1"}},{"insert":")\n","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-comment","lineId":"jK3AKUF1","lmkr":"1"}},{"insert":"\n","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-comment","lineId":"bZqL4oWW","lmkr":"1"}},{"insert":"# 打印二轮响应结果","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"\n","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-keyword","lineId":"AiFvxXAG","lmkr":"1"}},{"insert":"for chunk in second_response:\n","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-keyword","lineId":"gG92DPGg","lmkr":"1"}},{"insert":"    if","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" hasattr","attributes":{"clientside-highlight":"code-hljs-built_in"}},{"insert":"(chunk, 'delta'","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"):\n","attributes":{"clientside-highlight":"code-hljs-built_in"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-built_in","lineId":"xTnpuT5S","lmkr":"1"}},{"insert":"        print","attributes":{"clientside-highlight":"code-hljs-built_in"}},{"insert":"(chunk.delta, end=\"\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":", flush=True","attributes":{"clientside-highlight":"code-hljs-literal"}},{"insert":")\n"}],"zoneId":"DJtpAVdShi","zoneType":"Z"},"GezQjLa2YF":{"ops":[{"insert":"package","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" com.example.ark;\n"},{"insert":"\n"},{"insert":"import","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" com.volcengine.ark.runtime.model.responses.constant.ResponsesConstants;\n"},{"insert":"import","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" com.volcengine.ark.runtime.model.responses.event.StreamEvent;\n"},{"insert":"import","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" com.volcengine.ark.runtime.model.responses.request.ResponsesInput;\n"},{"insert":"import","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" com.volcengine.ark.runtime.model.responses.request.CreateResponsesRequest;\n"},{"insert":"import","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" com.volcengine.ark.runtime.model.responses.tool.ToolMCP;\n"},{"insert":"import","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" com.volcengine.ark.runtime.model.responses.tool.mcp.MCPRequireApproval;\n"},{"insert":"import","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" com.volcengine.ark.runtime.model.responses.event.reasoningsummary.ReasoningSummaryTextDeltaEvent;\n"},{"insert":"import","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" com.volcengine.ark.runtime.model.responses.event.outputitem.OutputItemDoneEvent;\n"},{"insert":"import","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" com.volcengine.ark.runtime.model.responses.event.outputtext.OutputTextDeltaEvent;\n"},{"insert":"import","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" com.volcengine.ark.runtime.service.ArkService;\n"},{"insert":"import","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" okhttp3.ConnectionPool;\n"},{"insert":"import","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" okhttp3.Dispatcher;\n"},{"insert":"import","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" com.volcengine.ark.runtime.model.responses.common.ResponsesThinking;\n"},{"insert":"import","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" com.volcengine.ark.runtime.model.responses.event.response.ResponseCompletedEvent;\n"},{"insert":"\n"},{"insert":"\n"},{"insert":"import","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" java.time.Duration;\n"},{"insert":"import","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" java.util.Collections;\n"},{"insert":"import","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" java.util.concurrent.TimeUnit;\n"},{"insert":"\n"},{"insert":"\n"},{"insert":"public","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" "},{"insert":"class","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" "},{"insert":"MCPToolCallExample","attributes":{"clientside-highlight":"code-hljs-title class_"}},{"insert":" {\n"},{"insert":"\n"},{"insert":"    "},{"insert":"// 固定使用的模型","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"\n"},{"insert":"    "},{"insert":"private","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" "},{"insert":"static","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" "},{"insert":"final","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" "},{"insert":"String","attributes":{"clientside-highlight":"code-hljs-type"}},{"insert":" "},{"insert":"model","attributes":{"clientside-highlight":"code-hljs-variable"}},{"insert":" "},{"insert":"=","attributes":{"clientside-highlight":"code-hljs-operator"}},{"insert":" "},{"insert":"\"doubao-seed-1-6-251015\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":";\n"},{"insert":"\n"},{"insert":"\n"},{"insert":"    "},{"insert":"public","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" "},{"insert":"static","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" "},{"insert":"void","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" "},{"insert":"main","attributes":{"clientside-highlight":"code-hljs-title function_"}},{"insert":"(String[] args)","attributes":{"clientside-highlight":"code-hljs-params"}},{"insert":" {\n"},{"insert":"        "},{"insert":"// 1. 校验鉴权凭证（必须配置 ARK_API_KEY 环境变量）","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"\n"},{"insert":"        "},{"insert":"String","attributes":{"clientside-highlight":"code-hljs-type"}},{"insert":" "},{"insert":"apiKey","attributes":{"clientside-highlight":"code-hljs-variable"}},{"insert":" "},{"insert":"=","attributes":{"clientside-highlight":"code-hljs-operator"}},{"insert":" System.getenv("},{"insert":"\"ARK_API_KEY\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":");\n"},{"insert":"        "},{"insert":"if","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" (apiKey == "},{"insert":"null","attributes":{"clientside-highlight":"code-hljs-literal"}},{"insert":") {\n"},{"insert":"            System.out.println("},{"insert":"\"ARK_API_KEY environment variable not set\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":");\n"},{"insert":"            "},{"insert":"return","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":";\n"},{"insert":"        }\n"},{"insert":"\n"},{"insert":"\n"},{"insert":"        "},{"insert":"// 2. 初始化 ArkService（配置连接池、并发、超时等）","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"\n"},{"insert":"        "},{"insert":"ConnectionPool","attributes":{"clientside-highlight":"code-hljs-type"}},{"insert":" "},{"insert":"connectionPool","attributes":{"clientside-highlight":"code-hljs-variable"}},{"insert":" "},{"insert":"=","attributes":{"clientside-highlight":"code-hljs-operator"}},{"insert":" "},{"insert":"new","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" "},{"insert":"ConnectionPool","attributes":{"clientside-highlight":"code-hljs-title class_"}},{"insert":"("},{"insert":"5","attributes":{"clientside-highlight":"code-hljs-number"}},{"insert":", "},{"insert":"1","attributes":{"clientside-highlight":"code-hljs-number"}},{"insert":", TimeUnit.SECONDS);\n"},{"insert":"        "},{"insert":"Dispatcher","attributes":{"clientside-highlight":"code-hljs-type"}},{"insert":" "},{"insert":"dispatcher","attributes":{"clientside-highlight":"code-hljs-variable"}},{"insert":" "},{"insert":"=","attributes":{"clientside-highlight":"code-hljs-operator"}},{"insert":" "},{"insert":"new","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" "},{"insert":"Dispatcher","attributes":{"clientside-highlight":"code-hljs-title class_"}},{"insert":"();\n"},{"insert":"        dispatcher.setMaxRequests("},{"insert":"5000","attributes":{"clientside-highlight":"code-hljs-number"}},{"insert":");\n"},{"insert":"        dispatcher.setMaxRequestsPerHost("},{"insert":"5000","attributes":{"clientside-highlight":"code-hljs-number"}},{"insert":");\n"},{"insert":"        "},{"insert":"ArkService","attributes":{"clientside-highlight":"code-hljs-type"}},{"insert":" "},{"insert":"service","attributes":{"clientside-highlight":"code-hljs-variable"}},{"insert":" "},{"insert":"=","attributes":{"clientside-highlight":"code-hljs-operator"}},{"insert":" ArkService.builder()\n"},{"insert":"                .dispatcher(dispatcher)\n"},{"insert":"                .timeout(Duration.ofHours("},{"insert":"1","attributes":{"clientside-highlight":"code-hljs-number"}},{"insert":"))\n"},{"insert":"                .connectionPool(connectionPool)\n"},{"insert":"                .apiKey(apiKey)\n"},{"insert":"                .build();\n"},{"insert":"\n"},{"insert":"\n"},{"insert":"        "},{"insert":"// 3. 构造 MCP 工具调用请求","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"\n"},{"insert":"        "},{"insert":"CreateResponsesRequest","attributes":{"clientside-highlight":"code-hljs-type"}},{"insert":" "},{"insert":"mcpRequest","attributes":{"clientside-highlight":"code-hljs-variable"}},{"insert":" "},{"insert":"=","attributes":{"clientside-highlight":"code-hljs-operator"}},{"insert":" CreateResponsesRequest.builder()\n"},{"insert":"                .model(model)\n"},{"insert":"                .stream("},{"insert":"true","attributes":{"clientside-highlight":"code-hljs-literal"}},{"insert":") "},{"insert":"// 流式响应，实时获取结果","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"\n"},{"insert":"                "},{"insert":"// 配置 MCP 工具：指定服务标签、服务地址、审批模式","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"\n"},{"insert":"                .tools(Collections.singletonList(\n"},{"insert":"                        ToolMCP.builder()\n"},{"insert":"                                .serverLabel("},{"insert":"\"deepwiki-test\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":") "},{"insert":"// MCP 服务标签（需提前在平台注册）","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"\n"},{"insert":"                                .serverUrl("},{"insert":"\"https://mcp.deepwiki.com/mcp\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":") "},{"insert":"// MCP 服务接口地址","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"\n"},{"insert":"                                "},{"insert":"// 审批模式：NEVER（无需审批）、ALWAYS（必须审批）、AUTO（自动审批）","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"\n"},{"insert":"                                .requireApproval(MCPRequireApproval.builder()\n"},{"insert":"                                        .mode(ResponsesConstants.MCP_APPROVAL_MODE_NEVER)\n"},{"insert":"                                        .build())\n"},{"insert":"                                .build()\n"},{"insert":"                ))\n"},{"insert":"                "},{"insert":"// 输入查询指令：让 MCP 工具查询指定仓库结构","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"\n"},{"insert":"                .input(ResponsesInput.builder()\n"},{"insert":"                        .stringValue("},{"insert":"\"查看这个 repo的structure expressjs/express\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":")\n"},{"insert":"                        .build())\n"},{"insert":"                "},{"insert":"// 启用模型思考过程（可在流式输出中查看）","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"\n"},{"insert":"                .thinking(ResponsesThinking.builder()\n"},{"insert":"                        .type(ResponsesConstants.THINKING_TYPE_ENABLED)\n"},{"insert":"                        .build())\n"},{"insert":"                .build();\n"},{"insert":"\n"},{"insert":"\n"},{"insert":"        "},{"insert":"// 4. 执行 MCP 工具调用并处理流式响应","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"\n"},{"insert":"        "},{"insert":"try","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" {\n"},{"insert":"            System.out.println("},{"insert":"\"----- [MCP Tool Call] 开始调用 -----\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":");\n"},{"insert":"            service.streamResponse(mcpRequest)\n"},{"insert":"                    .doOnError(Throwable::printStackTrace) "},{"insert":"// 异常处理","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"\n"},{"insert":"                    .blockingForEach(MCPToolCallExample::printStreamEvent); "},{"insert":"// 监听流式事件","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"\n"},{"insert":"        } "},{"insert":"catch","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" (Exception e) {\n"},{"insert":"            System.err.println("},{"insert":"\"MCP Tool Call Error: \"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":" + e.getMessage());\n"},{"insert":"        }\n"},{"insert":"\n"},{"insert":"\n"},{"insert":"        "},{"insert":"// 5. 关闭服务 executor，释放资源","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"\n"},{"insert":"        service.shutdownExecutor();\n"},{"insert":"    }\n"},{"insert":"\n"},{"insert":"\n"},{"insert":"    "},{"insert":"// 流式事件处理：打印思考过程、响应内容、工具调用状态","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"\n"},{"insert":"    "},{"insert":"private","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" "},{"insert":"static","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" "},{"insert":"void","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" "},{"insert":"printStreamEvent","attributes":{"clientside-highlight":"code-hljs-title function_"}},{"insert":"(StreamEvent event)","attributes":{"clientside-highlight":"code-hljs-params"}},{"insert":" {\n"},{"insert":"        "},{"insert":"// 打印思考过程增量（如模型分析如何调用 MCP 工具）","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"\n"},{"insert":"        "},{"insert":"if","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" (event "},{"insert":"instanceof","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" ReasoningSummaryTextDeltaEvent) {\n"},{"insert":"            System.out.print("},{"insert":"\"[思考过程] \"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":" + ((ReasoningSummaryTextDeltaEvent) event).getDelta());\n"},{"insert":"        }\n"},{"insert":"        "},{"insert":"// 打印文本响应增量（MCP 工具返回结果的实时输出）","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"\n"},{"insert":"        "},{"insert":"if","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" (event "},{"insert":"instanceof","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" OutputTextDeltaEvent) {\n"},{"insert":"            System.out.print("},{"insert":"\"[工具返回] \"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":" + ((OutputTextDeltaEvent) event).getDelta());\n"},{"insert":"        }\n"},{"insert":"        "},{"insert":"// 工具调用项结束标识","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"\n"},{"insert":"        "},{"insert":"if","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" (event "},{"insert":"instanceof","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" OutputItemDoneEvent) {\n"},{"insert":"            System.out.println("},{"insert":"\"\\n[调用结束] 工具类型：\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":" + ((OutputItemDoneEvent) event).getItem().getType() + "},{"insert":"\"\\n\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":");\n"},{"insert":"        }\n"},{"insert":"        "},{"insert":"// 整体响应完成，打印调用用量","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"\n"},{"insert":"        "},{"insert":"if","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" (event "},{"insert":"instanceof","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" ResponseCompletedEvent) {\n"},{"insert":"            System.out.println("},{"insert":"\"[响应完成] 调用用量：\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":" + ((ResponseCompletedEvent) event).getResponse().getUsage());\n"},{"insert":"        }\n"},{"insert":"    }\n"},{"insert":"}\n"}],"zoneId":"GezQjLa2YF","zoneType":"Z"},"MRzMBYtlMc":{"ops":[{"insert":"*","attributes":{"lineId":"knr3dFEl","lmkr":"1"}},{"insert":"\"tools\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":": [\n"},{"insert":"*","attributes":{"lineId":"53kZmBVQ","lmkr":"1"}},{"insert":"    {\n"},{"insert":"*","attributes":{"lineId":"ZGw5vMv2","lmkr":"1"}},{"insert":"          "},{"insert":"  \"type\": \"mcp\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":",\n"},{"insert":"*","attributes":{"lineId":"lz1fGdG7","lmkr":"1"}},{"insert":"         "},{"insert":"   \"server_label\": \"info-quest-mcp\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":", \n"},{"insert":"*","attributes":{"lineId":"udwXUKma","lmkr":"1"}},{"insert":"        "},{"insert":"    \"server_url\": \"https://mcp.infoquest.bytepluses.com/mcp\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":",  # 某MCP工具提供的MCP服务地址","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"\n"},{"insert":"*","attributes":{"lineId":"zlJ9GVuS","lmkr":"1"}},{"insert":"       "},{"insert":"     \"require_approval\": \"never\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":", \n"},{"insert":"*","attributes":{"lineId":"AJS6OBW0","lmkr":"1"}},{"insert":"      "},{"insert":"      \"headers\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":": {\n"},{"insert":"*","attributes":{"lineId":"F5pB9ALc","lmkr":"1"}},{"insert":"         "},{"insert":"       \"Authorization\": \"******\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"  # 替换为MCP工具提供的认证信息","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"\n"},{"insert":"*","attributes":{"lineId":"d1WZI5Op","lmkr":"1"}},{"insert":"            }\n"},{"insert":"*","attributes":{"lineId":"xAZhwdSS","lmkr":"1"}},{"insert":"        }\n"},{"insert":"*","attributes":{"lineId":"gdTv9Ss3","lmkr":"1"}},{"insert":"]\n"}],"zoneId":"MRzMBYtlMc","zoneType":"Z"},"PCOLJjKgum":{"ops":[{"insert":" ","attributes":{"tabContent":"true","title":"Python SDK","zoneId":"nvC1X0TWC4"}},{"insert":"\n"}],"zoneId":"PCOLJjKgum","zoneType":"Z"},"UAZpksggoE":{"ops":[{"insert":" ","attributes":{"language":"Go","type":"codeblock","zoneId":"b9lDGit8r5"}},{"insert":"\n"}],"zoneId":"UAZpksggoE","zoneType":"Z"},"USc7KV3uVV":{"ops":[{"insert":" ","attributes":{"language":"Python","type":"codeblock","zoneId":"v2Wc53H5LG"}},{"insert":"\n"}],"zoneId":"USc7KV3uVV","zoneType":"Z"},"Y0oxbwbsHz":{"ops":[{"insert":" ","attributes":{"language":"Java","type":"codeblock","zoneId":"GezQjLa2YF"}},{"insert":"\n"}],"zoneId":"Y0oxbwbsHz","zoneType":"Z"},"b9lDGit8r5":{"ops":[{"insert":"import","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" (\n"},{"insert":"        "},{"insert":"\"context\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"\n"},{"insert":"        "},{"insert":"\"fmt\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"\n"},{"insert":"        "},{"insert":"\"github.com/volcengine/volcengine-go-sdk/service/arkruntime\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"\n"},{"insert":"        "},{"insert":"\"github.com/volcengine/volcengine-go-sdk/service/arkruntime/model/responses\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"\n"},{"insert":"        "},{"insert":"\"io\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"\n"},{"insert":"        "},{"insert":"\"os\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"\n"},{"insert":")\n"},{"insert":"\n"},{"insert":"/**\n","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":" * Authentication\n","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":" * If you authorize your endpoint using an API key, you can set your api key to environment variable \"ARK_API_KEY\"\n","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":" * client := arkruntime.NewClientWithApiKey(os.Getenv(\"ARK_API_KEY\"))\n","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":" * Note: If you use an API key, this API key will not be refreshed.\n","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":" * To prevent the API from expiring and failing after some time, choose an API key with no expiration date.\n","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":" */","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"\n"},{"insert":"\n"},{"insert":"func","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" ","attributes":{"clientside-highlight":"code-hljs-function"}},{"insert":"main","attributes":{"clientside-highlight":"code-hljs-title"}},{"insert":"()","attributes":{"clientside-highlight":"code-hljs-params"}},{"insert":" {\n"},{"insert":"        stream()\n"},{"insert":"        nonStream()\n"},{"insert":"}\n"},{"insert":"\n"},{"insert":"func","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" ","attributes":{"clientside-highlight":"code-hljs-function"}},{"insert":"nonStream","attributes":{"clientside-highlight":"code-hljs-title"}},{"insert":"()","attributes":{"clientside-highlight":"code-hljs-params"}},{"insert":" {\n"},{"insert":"        fmt.Println("},{"insert":"\"non stream\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":")\n"},{"insert":"        client := arkruntime.NewClientWithApiKey(os.Getenv("},{"insert":"\"ARK_API_KEY\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"))\n"},{"insert":"        ctx := context.Background()\n"},{"insert":"\n"},{"insert":"        fmt.Println("},{"insert":"\"----- round 1 message -----\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":")\n"},{"insert":"        "},{"insert":"// round 1 message","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"\n"},{"insert":"        serverDescription := "},{"insert":"\"test desc\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"\n"},{"insert":"        inputMessage := \u0026responses.ItemInputMessage{\n"},{"insert":"                Role: responses.MessageRole_user,\n"},{"insert":"                Content: []*responses.ContentItem{\n"},{"insert":"                        {\n"},{"insert":"                                Union: \u0026responses.ContentItem_Text{\n"},{"insert":"                                        Text: \u0026responses.ContentItemText{\n"},{"insert":"                                                Type: responses.ContentItemType_input_text,\n"},{"insert":"                                                Text: "},{"insert":"\"查一下 mark3labs/mcp-go 这个仓库的结构\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":",\n"},{"insert":"                                        },\n"},{"insert":"                                },\n"},{"insert":"                        },\n"},{"insert":"                },\n"},{"insert":"        }\n"},{"insert":"        createResponsesReq := \u0026responses.ResponsesRequest{\n"},{"insert":"                Model: "},{"insert":"\"doubao-seed-1-6-251015\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":",\n"},{"insert":"                Input: \u0026responses.ResponsesInput{\n"},{"insert":"                        Union: \u0026responses.ResponsesInput_ListValue{\n"},{"insert":"                                ListValue: \u0026responses.InputItemList{ListValue: []*responses.InputItem{{\n"},{"insert":"                                        Union: \u0026responses.InputItem_InputMessage{\n"},{"insert":"                                                InputMessage: inputMessage,\n"},{"insert":"                                        },\n"},{"insert":"                                }}},\n"},{"insert":"                        },\n"},{"insert":"                },\n"},{"insert":"                "},{"insert":"//Caching: \u0026responses.ResponsesCaching{Type: responses.CacheType_enabled.Enum()},","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"\n"},{"insert":"                Tools: []*responses.ResponsesTool{\n"},{"insert":"                        {\n"},{"insert":"                                Union: \u0026responses.ResponsesTool_ToolMcp{\n"},{"insert":"                                        ToolMcp: \u0026responses.ToolMcp{\n"},{"insert":"                                                Type:              responses.ToolType_mcp,\n"},{"insert":"                                                ServerLabel:       "},{"insert":"\"deepwiki\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":",\n"},{"insert":"                                                ServerDescription: \u0026serverDescription,\n"},{"insert":"                                                ServerUrl:         "},{"insert":"\"https://mcp.deepwiki.com/mcp\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":",\n"},{"insert":"                                        },\n"},{"insert":"                                },\n"},{"insert":"                        },\n"},{"insert":"                },\n"},{"insert":"        }\n"},{"insert":"\n"},{"insert":"        resp, err := client.CreateResponses(ctx, createResponsesReq, arkruntime.WithCustomHeader("},{"insert":"\"ark-beta-mcp\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":", "},{"insert":"\"true\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"))\n"},{"insert":"        "},{"insert":"if","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" err != "},{"insert":"nil","attributes":{"clientside-highlight":"code-hljs-literal"}},{"insert":" {\n"},{"insert":"                fmt.Printf("},{"insert":"\"stream error: %v\\n\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":", err)\n"},{"insert":"                "},{"insert":"return","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":"\n"},{"insert":"        }\n"},{"insert":"        "},{"insert":"var","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" responseId "},{"insert":"string","attributes":{"clientside-highlight":"code-hljs-type"}},{"insert":"\n"},{"insert":"        "},{"insert":"var","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" approvalRequestId "},{"insert":"string","attributes":{"clientside-highlight":"code-hljs-type"}},{"insert":"\n"},{"insert":"        fmt.Printf("},{"insert":"\"response: %v\\n\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":", resp)\n"},{"insert":"        responseId = resp.Id\n"},{"insert":"        approvalRequestId = resp.Output["},{"insert":"len","attributes":{"clientside-highlight":"code-hljs-built_in"}},{"insert":"(resp.Output)"},{"insert":"-1","attributes":{"clientside-highlight":"code-hljs-number"}},{"insert":"].GetFunctionMcpApprovalRequest().GetId()\n"},{"insert":"\n"},{"insert":"        fmt.Println()\n"},{"insert":"        fmt.Println("},{"insert":"\"-----round 2---------\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":")\n"},{"insert":"        createResponsesReq2 := \u0026responses.ResponsesRequest{\n"},{"insert":"                Model: "},{"insert":"\"doubao-seed-1-6-251015\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":",\n"},{"insert":"                Input: \u0026responses.ResponsesInput{\n"},{"insert":"                        Union: \u0026responses.ResponsesInput_ListValue{\n"},{"insert":"                                ListValue: \u0026responses.InputItemList{ListValue: []*responses.InputItem{{\n"},{"insert":"                                        Union: \u0026responses.InputItem_McpApprovalResponse{\n"},{"insert":"                                                McpApprovalResponse: \u0026responses.ItemFunctionMcpApprovalResponse{\n"},{"insert":"                                                        Type:              responses.ItemType_mcp_approval_response,\n"},{"insert":"                                                        ApprovalRequestId: approvalRequestId,\n"},{"insert":"                                                        Approve:           "},{"insert":"true","attributes":{"clientside-highlight":"code-hljs-literal"}},{"insert":",\n"},{"insert":"                                                },\n"},{"insert":"                                        },\n"},{"insert":"                                }}},\n"},{"insert":"                        },\n"},{"insert":"                },\n"},{"insert":"                Tools: []*responses.ResponsesTool{\n"},{"insert":"                        {\n"},{"insert":"                                Union: \u0026responses.ResponsesTool_ToolMcp{\n"},{"insert":"                                        ToolMcp: \u0026responses.ToolMcp{\n"},{"insert":"                                                Type:              responses.ToolType_mcp,\n"},{"insert":"                                                ServerLabel:       "},{"insert":"\"deepwiki\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":",\n"},{"insert":"                                                ServerDescription: \u0026serverDescription,\n"},{"insert":"                                                ServerUrl:         "},{"insert":"\"https://mcp.deepwiki.com/mcp\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":",\n"},{"insert":"                                        },\n"},{"insert":"                                },\n"},{"insert":"                        },\n"},{"insert":"                },\n"},{"insert":"                PreviousResponseId: \u0026responseId,\n"},{"insert":"        }\n"},{"insert":"        resp2, err := client.CreateResponses(ctx, createResponsesReq2, arkruntime.WithCustomHeader("},{"insert":"\"ark-beta-mcp\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":", "},{"insert":"\"true\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"))\n"},{"insert":"        "},{"insert":"if","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" err != "},{"insert":"nil","attributes":{"clientside-highlight":"code-hljs-literal"}},{"insert":" {\n"},{"insert":"                fmt.Printf("},{"insert":"\"stream error: %v\\n\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":", err)\n"},{"insert":"                "},{"insert":"return","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":"\n"},{"insert":"        }\n"},{"insert":"        fmt.Printf("},{"insert":"\"response: %v\\n\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":", resp2)\n"},{"insert":"\n"},{"insert":"        fmt.Println("},{"insert":"\"----- round 3 never require approval -----\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":")\n"},{"insert":"        createResponsesReq3 := \u0026responses.ResponsesRequest{\n"},{"insert":"                Model: "},{"insert":"\"doubao-seed-1-6-251015\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":",\n"},{"insert":"                Input: \u0026responses.ResponsesInput{\n"},{"insert":"                        Union: \u0026responses.ResponsesInput_ListValue{\n"},{"insert":"                                ListValue: \u0026responses.InputItemList{ListValue: []*responses.InputItem{{\n"},{"insert":"                                        Union: \u0026responses.InputItem_InputMessage{\n"},{"insert":"                                                InputMessage: inputMessage,\n"},{"insert":"                                        },\n"},{"insert":"                                }}},\n"},{"insert":"                        },\n"},{"insert":"                },\n"},{"insert":"                Tools: []*responses.ResponsesTool{\n"},{"insert":"                        {\n"},{"insert":"                                Union: \u0026responses.ResponsesTool_ToolMcp{\n"},{"insert":"                                        ToolMcp: \u0026responses.ToolMcp{\n"},{"insert":"                                                Type:              responses.ToolType_mcp,\n"},{"insert":"                                                ServerLabel:       "},{"insert":"\"deepwiki\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":",\n"},{"insert":"                                                ServerDescription: \u0026serverDescription,\n"},{"insert":"                                                ServerUrl:         "},{"insert":"\"https://mcp.deepwiki.com/mcp\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":",\n"},{"insert":"                                                RequireApproval: \u0026responses.McpRequireApproval{\n"},{"insert":"                                                        Union: \u0026responses.McpRequireApproval_Mode{\n"},{"insert":"                                                                Mode: responses.ApprovalMode_never,\n"},{"insert":"                                                        },\n"},{"insert":"                                                },\n"},{"insert":"                                        },\n"},{"insert":"                                },\n"},{"insert":"                        },\n"},{"insert":"                },\n"},{"insert":"        }\n"},{"insert":"\n"},{"insert":"        resp3, err := client.CreateResponses(ctx, createResponsesReq3, arkruntime.WithCustomHeader("},{"insert":"\"ark-beta-mcp\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":", "},{"insert":"\"true\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"))\n"},{"insert":"        fmt.Printf("},{"insert":"\"response: %v\\n\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":", resp3)\n"},{"insert":"}\n"},{"insert":"\n"},{"insert":"func","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" ","attributes":{"clientside-highlight":"code-hljs-function"}},{"insert":"stream","attributes":{"clientside-highlight":"code-hljs-title"}},{"insert":"()","attributes":{"clientside-highlight":"code-hljs-params"}},{"insert":" {\n"},{"insert":"        fmt.Println("},{"insert":"\"stream\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":")\n"},{"insert":"\n"},{"insert":"        client := arkruntime.NewClientWithApiKey(os.Getenv("},{"insert":"\"ARK_API_KEY\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"))\n"},{"insert":"        ctx := context.Background()\n"},{"insert":"\n"},{"insert":"        fmt.Println("},{"insert":"\"----- round 1 message -----\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":")\n"},{"insert":"        "},{"insert":"// round 1 message","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"\n"},{"insert":"        serverDescription := "},{"insert":"\"test desc\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"\n"},{"insert":"        inputMessage := \u0026responses.ItemInputMessage{\n"},{"insert":"                Role: responses.MessageRole_user,\n"},{"insert":"                Content: []*responses.ContentItem{\n"},{"insert":"                        {\n"},{"insert":"                                Union: \u0026responses.ContentItem_Text{\n"},{"insert":"                                        Text: \u0026responses.ContentItemText{\n"},{"insert":"                                                Type: responses.ContentItemType_input_text,\n"},{"insert":"                                                Text: "},{"insert":"\"查一下 mark3labs/mcp-go 这个仓库的结构\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":",\n"},{"insert":"                                        },\n"},{"insert":"                                },\n"},{"insert":"                        },\n"},{"insert":"                },\n"},{"insert":"        }\n"},{"insert":"        createResponsesReq := \u0026responses.ResponsesRequest{\n"},{"insert":"                Model: "},{"insert":"\"doubao-seed-1-6-251015\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":",\n"},{"insert":"                Input: \u0026responses.ResponsesInput{\n"},{"insert":"                        Union: \u0026responses.ResponsesInput_ListValue{\n"},{"insert":"                                ListValue: \u0026responses.InputItemList{ListValue: []*responses.InputItem{{\n"},{"insert":"                                        Union: \u0026responses.InputItem_InputMessage{\n"},{"insert":"                                                InputMessage: inputMessage,\n"},{"insert":"                                        },\n"},{"insert":"                                }}},\n"},{"insert":"                        },\n"},{"insert":"                },\n"},{"insert":"                "},{"insert":"//Caching: \u0026responses.ResponsesCaching{Type: responses.CacheType_enabled.Enum()},","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"\n"},{"insert":"                Tools: []*responses.ResponsesTool{\n"},{"insert":"                        {\n"},{"insert":"                                Union: \u0026responses.ResponsesTool_ToolMcp{\n"},{"insert":"                                        ToolMcp: \u0026responses.ToolMcp{\n"},{"insert":"                                                Type:              responses.ToolType_mcp,\n"},{"insert":"                                                ServerLabel:       "},{"insert":"\"deepwiki\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":",\n"},{"insert":"                                                ServerDescription: \u0026serverDescription,\n"},{"insert":"                                                ServerUrl:         "},{"insert":"\"https://mcp.deepwiki.com/mcp\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":",\n"},{"insert":"                                        },\n"},{"insert":"                                },\n"},{"insert":"                        },\n"},{"insert":"                },\n"},{"insert":"        }\n"},{"insert":"\n"},{"insert":"        resp, err := client.CreateResponsesStream(ctx, createResponsesReq, arkruntime.WithCustomHeader("},{"insert":"\"ark-beta-mcp\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":", "},{"insert":"\"true\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"))\n"},{"insert":"        "},{"insert":"if","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" err != "},{"insert":"nil","attributes":{"clientside-highlight":"code-hljs-literal"}},{"insert":" {\n"},{"insert":"                fmt.Printf("},{"insert":"\"stream error: %v\\n\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":", err)\n"},{"insert":"                "},{"insert":"return","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":"\n"},{"insert":"        }\n"},{"insert":"        "},{"insert":"var","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" responseId "},{"insert":"string","attributes":{"clientside-highlight":"code-hljs-type"}},{"insert":"\n"},{"insert":"        "},{"insert":"var","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" approvalRequestId "},{"insert":"string","attributes":{"clientside-highlight":"code-hljs-type"}},{"insert":"\n"},{"insert":"        "},{"insert":"for","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" {\n"},{"insert":"                event, err := resp.Recv()\n"},{"insert":"                "},{"insert":"if","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" err == io.EOF {\n"},{"insert":"                        "},{"insert":"break","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":"\n"},{"insert":"                }\n"},{"insert":"                "},{"insert":"if","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" err != "},{"insert":"nil","attributes":{"clientside-highlight":"code-hljs-literal"}},{"insert":" {\n"},{"insert":"                        fmt.Printf("},{"insert":"\"stream error: %v\\n\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":", err)\n"},{"insert":"                        "},{"insert":"return","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":"\n"},{"insert":"                }\n"},{"insert":"                handleEvent(event)\n"},{"insert":"                "},{"insert":"if","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" responseEvent := event.GetResponse(); responseEvent != "},{"insert":"nil","attributes":{"clientside-highlight":"code-hljs-literal"}},{"insert":" {\n"},{"insert":"                        responseId = responseEvent.GetResponse().GetId()\n"},{"insert":"                }\n"},{"insert":"                "},{"insert":"if","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" event.GetItem().GetItem().GetFunctionMcpApprovalRequest() != "},{"insert":"nil","attributes":{"clientside-highlight":"code-hljs-literal"}},{"insert":" {\n"},{"insert":"                        approvalRequestId = event.GetItem().GetItem().GetFunctionMcpApprovalRequest().GetId()\n"},{"insert":"                }\n"},{"insert":"        }\n"},{"insert":"\n"},{"insert":"        fmt.Println()\n"},{"insert":"        fmt.Println("},{"insert":"\"-----round 2---------\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":")\n"},{"insert":"        createResponsesReq2 := \u0026responses.ResponsesRequest{\n"},{"insert":"                Model: "},{"insert":"\"doubao-seed-1-6-251015\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":",\n"},{"insert":"                Input: \u0026responses.ResponsesInput{\n"},{"insert":"                        Union: \u0026responses.ResponsesInput_ListValue{\n"},{"insert":"                                ListValue: \u0026responses.InputItemList{ListValue: []*responses.InputItem{{\n"},{"insert":"                                        Union: \u0026responses.InputItem_McpApprovalResponse{\n"},{"insert":"                                                McpApprovalResponse: \u0026responses.ItemFunctionMcpApprovalResponse{\n"},{"insert":"                                                        Type:              responses.ItemType_mcp_approval_response,\n"},{"insert":"                                                        ApprovalRequestId: approvalRequestId,\n"},{"insert":"                                                        Approve:           "},{"insert":"true","attributes":{"clientside-highlight":"code-hljs-literal"}},{"insert":",\n"},{"insert":"                                                },\n"},{"insert":"                                        },\n"},{"insert":"                                }}},\n"},{"insert":"                        },\n"},{"insert":"                },\n"},{"insert":"                "},{"insert":"//Caching: \u0026responses.ResponsesCaching{Type: responses.CacheType_enabled.Enum()},","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"\n"},{"insert":"                Tools: []*responses.ResponsesTool{\n"},{"insert":"                        {\n"},{"insert":"                                Union: \u0026responses.ResponsesTool_ToolMcp{\n"},{"insert":"                                        ToolMcp: \u0026responses.ToolMcp{\n"},{"insert":"                                                Type:              responses.ToolType_mcp,\n"},{"insert":"                                                ServerLabel:       "},{"insert":"\"deepwiki\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":",\n"},{"insert":"                                                ServerDescription: \u0026serverDescription,\n"},{"insert":"                                                ServerUrl:         "},{"insert":"\"https://mcp.deepwiki.com/mcp\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":",\n"},{"insert":"                                        },\n"},{"insert":"                                },\n"},{"insert":"                        },\n"},{"insert":"                },\n"},{"insert":"                PreviousResponseId: \u0026responseId,\n"},{"insert":"        }\n"},{"insert":"        resp2, err := client.CreateResponsesStream(ctx, createResponsesReq2, arkruntime.WithCustomHeader("},{"insert":"\"ark-beta-mcp\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":", "},{"insert":"\"true\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"))\n"},{"insert":"        "},{"insert":"if","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" err != "},{"insert":"nil","attributes":{"clientside-highlight":"code-hljs-literal"}},{"insert":" {\n"},{"insert":"                fmt.Printf("},{"insert":"\"stream error: %v\\n\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":", err)\n"},{"insert":"                "},{"insert":"return","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":"\n"},{"insert":"        }\n"},{"insert":"        "},{"insert":"for","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" {\n"},{"insert":"                event, err := resp2.Recv()\n"},{"insert":"                "},{"insert":"if","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" err == io.EOF {\n"},{"insert":"                        "},{"insert":"break","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":"\n"},{"insert":"                }\n"},{"insert":"                "},{"insert":"if","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" err != "},{"insert":"nil","attributes":{"clientside-highlight":"code-hljs-literal"}},{"insert":" {\n"},{"insert":"                        fmt.Printf("},{"insert":"\"stream error: %v\\n\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":", err)\n"},{"insert":"                        "},{"insert":"return","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":"\n"},{"insert":"                }\n"},{"insert":"                handleEvent(event)\n"},{"insert":"        }\n"},{"insert":"\n"},{"insert":"        fmt.Println("},{"insert":"\"----- round 3 never require approval -----\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":")\n"},{"insert":"        createResponsesReq3 := \u0026responses.ResponsesRequest{\n"},{"insert":"                Model: "},{"insert":"\"doubao-seed-1-6-251015\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":",\n"},{"insert":"                Input: \u0026responses.ResponsesInput{\n"},{"insert":"                        Union: \u0026responses.ResponsesInput_ListValue{\n"},{"insert":"                                ListValue: \u0026responses.InputItemList{ListValue: []*responses.InputItem{{\n"},{"insert":"                                        Union: \u0026responses.InputItem_InputMessage{\n"},{"insert":"                                                InputMessage: inputMessage,\n"},{"insert":"                                        },\n"},{"insert":"                                }}},\n"},{"insert":"                        },\n"},{"insert":"                },\n"},{"insert":"                Tools: []*responses.ResponsesTool{\n"},{"insert":"                        {\n"},{"insert":"                                Union: \u0026responses.ResponsesTool_ToolMcp{\n"},{"insert":"                                        ToolMcp: \u0026responses.ToolMcp{\n"},{"insert":"                                                Type:              responses.ToolType_mcp,\n"},{"insert":"                                                ServerLabel:       "},{"insert":"\"deepwiki\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":",\n"},{"insert":"                                                ServerDescription: \u0026serverDescription,\n"},{"insert":"                                                ServerUrl:         "},{"insert":"\"https://mcp.deepwiki.com/mcp\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":",\n"},{"insert":"                                                RequireApproval: \u0026responses.McpRequireApproval{\n"},{"insert":"                                                        Union: \u0026responses.McpRequireApproval_Mode{\n"},{"insert":"                                                                Mode: responses.ApprovalMode_never,\n"},{"insert":"                                                        },\n"},{"insert":"                                                },\n"},{"insert":"                                        },\n"},{"insert":"                                },\n"},{"insert":"                        },\n"},{"insert":"                },\n"},{"insert":"        }\n"},{"insert":"\n"},{"insert":"        resp3, err := client.CreateResponsesStream(ctx, createResponsesReq3, arkruntime.WithCustomHeader("},{"insert":"\"ark-beta-mcp\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":", "},{"insert":"\"true\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"))\n"},{"insert":"        "},{"insert":"if","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" err != "},{"insert":"nil","attributes":{"clientside-highlight":"code-hljs-literal"}},{"insert":" {\n"},{"insert":"                fmt.Printf("},{"insert":"\"stream error: %v\\n\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":", err)\n"},{"insert":"                "},{"insert":"return","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":"\n"},{"insert":"        }\n"},{"insert":"        "},{"insert":"for","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" {\n"},{"insert":"                event, err := resp3.Recv()\n"},{"insert":"                "},{"insert":"if","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" err == io.EOF {\n"},{"insert":"                        "},{"insert":"break","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":"\n"},{"insert":"                }\n"},{"insert":"                "},{"insert":"if","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" err != "},{"insert":"nil","attributes":{"clientside-highlight":"code-hljs-literal"}},{"insert":" {\n"},{"insert":"                        fmt.Printf("},{"insert":"\"stream error: %v\\n\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":", err)\n"},{"insert":"                        "},{"insert":"return","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":"\n"},{"insert":"                }\n"},{"insert":"                handleEvent(event)\n"},{"insert":"        }\n"},{"insert":"}\n"},{"insert":"\n"},{"insert":"func","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" ","attributes":{"clientside-highlight":"code-hljs-function"}},{"insert":"handleEvent","attributes":{"clientside-highlight":"code-hljs-title"}},{"insert":"(event *responses.Event)","attributes":{"clientside-highlight":"code-hljs-params"}},{"insert":" {\n"},{"insert":"        "},{"insert":"switch","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" event.GetEventType() {\n"},{"insert":"        "},{"insert":"case","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" responses.EventType_response_reasoning_summary_text_delta.String():\n"},{"insert":"                "},{"insert":"print","attributes":{"clientside-highlight":"code-hljs-built_in"}},{"insert":"(event.GetReasoningText().GetDelta())\n"},{"insert":"        "},{"insert":"case","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" responses.EventType_response_reasoning_summary_text_done.String(): "},{"insert":"// aggregated reasoning text","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"\n"},{"insert":"                fmt.Printf("},{"insert":"\"\\naggregated reasoning text: %s\\n\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":", event.GetReasoningText().GetText())\n"},{"insert":"        "},{"insert":"case","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" responses.EventType_response_output_text_delta.String():\n"},{"insert":"                "},{"insert":"print","attributes":{"clientside-highlight":"code-hljs-built_in"}},{"insert":"(event.GetText().GetDelta())\n"},{"insert":"        "},{"insert":"case","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" responses.EventType_response_output_text_done.String(): "},{"insert":"// aggregated output text","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"\n"},{"insert":"                fmt.Printf("},{"insert":"\"\\naggregated output text: %s\\n\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":", event.GetText().GetText())\n"},{"insert":"        "},{"insert":"case","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" responses.EventType_response_output_item_done.String():\n"},{"insert":"                "},{"insert":"if","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" event.GetItem().GetItem().GetFunctionMcpApprovalRequest() != "},{"insert":"nil","attributes":{"clientside-highlight":"code-hljs-literal"}},{"insert":" {\n"},{"insert":"                        fmt.Printf("},{"insert":"\"\\nmcp call: %s; arguments %s\\n\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":", event.GetItem().GetItem().GetFunctionMcpApprovalRequest().GetName(), event.GetItem().GetItem().GetFunctionMcpApprovalRequest().GetArguments())\n"},{"insert":"                }\n"},{"insert":"        "},{"insert":"case","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" responses.EventType_response_mcp_call_arguments_delta.String():\n"},{"insert":"                fmt.Printf("},{"insert":"\"\\nmcp call arguments: %s\\n\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":", event.GetResponseMcpCallArgumentsDelta().GetDelta())\n"},{"insert":"        "},{"insert":"case","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" responses.EventType_response_mcp_call_completed.String():\n"},{"insert":"                fmt.Printf("},{"insert":"\"\\nmcp call completed.\\n\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":")\n"},{"insert":"        "},{"insert":"case","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" responses.EventType_response_mcp_list_tools_in_progress.String():\n"},{"insert":"                fmt.Printf("},{"insert":"\"\\nlisting mcp tools.\\n\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":")\n"},{"insert":"        "},{"insert":"case","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" responses.EventType_response_mcp_list_tools_completed.String():\n"},{"insert":"                fmt.Printf("},{"insert":"\"\\nDone listing mcp tools.\\n\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":")\n"},{"insert":"        "},{"insert":"default","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":":\n"},{"insert":"                "},{"insert":"return","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":"\n"},{"insert":"        }\n"},{"insert":"}\n"}],"zoneId":"b9lDGit8r5","zoneType":"Z"},"erR9VXeB8A":{"ops":[{"insert":" ","attributes":{"language":"Bash","type":"codeblock","zoneId":"pzTBYD1LkB"}},{"insert":"\n"}],"zoneId":"erR9VXeB8A","zoneType":"Z"},"exotrfwuk3":{"ops":[{"insert":" ","attributes":{"language":"Python","type":"codeblock","zoneId":"uaZKyZZvFB"}},{"insert":"\n"}],"zoneId":"exotrfwuk3","zoneType":"Z"},"nvC1X0TWC4":{"ops":[{"insert":" ","attributes":{"language":"Python","type":"codeblock","zoneId":"DJtpAVdShi"}},{"insert":"\n"}],"zoneId":"nvC1X0TWC4","zoneType":"Z"},"oW0ppPsl2y":{"ops":[{"insert":" ","attributes":{"tabContent":"true","title":"curl","zoneId":"erR9VXeB8A"}},{"insert":" ","attributes":{"tabContent":"true","title":"Python SDK","zoneId":"USc7KV3uVV"}},{"insert":" ","attributes":{"tabContent":"true","title":"Java SDK","zoneId":"Y0oxbwbsHz"}},{"insert":" ","attributes":{"tabContent":"true","title":"Go SDK","zoneId":"UAZpksggoE"}},{"insert":" ","attributes":{"tabContent":"true","title":"Open AI Python SDK","zoneId":"exotrfwuk3"}},{"insert":"\n"}],"zoneId":"oW0ppPsl2y","zoneType":"Z"},"pzTBYD1LkB":{"ops":[{"insert":"*","attributes":{"lineId":"OUMshGfE","lmkr":"1"}},{"insert":"curl --location "},{"insert":"'https://ark.cn-beijing.volces.com/api/v3/responses'","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":" \\\\\n"},{"insert":"*","attributes":{"lineId":"ZNKlK2Rh","lmkr":"1"}},{"insert":"--header"},{"insert":" \"Authorization: Bearer \u003cARK_API_KEY\u003e\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":" \\\\\n"},{"insert":"*","attributes":{"lineId":"XxrJq2Jh","lmkr":"1"}},{"insert":"--heade"},{"insert":"r 'Content-Type: application/json'","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":" \\\\\n"},{"insert":"*","attributes":{"lineId":"jhUYTc6B","lmkr":"1"}},{"insert":"--head"},{"insert":"er 'ark-beta-mcp: true'","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":" \\\\\n"},{"insert":"*","attributes":{"lineId":"WHz5hJOS","lmkr":"1"}},{"insert":"--d"},{"insert":"ata '{\n","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-string","lineId":"skULHWoO","lmkr":"1"}},{"insert":"    \"model\": \"doubao-seed-1-6-251015\",\n","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-string","lineId":"s4oYDOF3","lmkr":"1"}},{"insert":"    \"stream\": true,\n","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-string","lineId":"h3QWBNh6","lmkr":"1"}},{"insert":"    \"tools\": [\n","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-string","lineId":"7520SjOl","lmkr":"1"}},{"insert":"        {\n","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-string","lineId":"7dAxpfTZ","lmkr":"1"}},{"insert":"            \"type\": \"mcp\",\n","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-string","lineId":"Z225i6Ae","lmkr":"1"}},{"insert":"            \"server_label\": \"deepwiki\",\n","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-string","lineId":"4B9UwXNF","lmkr":"1"}},{"insert":"            \"server_url\": \"https://mcp.deepwiki.com/mcp\",\n","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-string","lineId":"LKPofYux","lmkr":"1"}},{"insert":"            \"require_approval\": \"never\"  # 无需审批，直接调用\n","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-string","lineId":"qZDaKnzD","lmkr":"1"}},{"insert":"        }\n","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-string","lineId":"GmIGSeN2","lmkr":"1"}},{"insert":"    ],\n","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-string","lineId":"xoSuu2V0","lmkr":"1"}},{"insert":"    \"input\": [\n","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-string","lineId":"0t1KgJOT","lmkr":"1"}},{"insert":"        {\n","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-string","lineId":"cx9sRiA8","lmkr":"1"}},{"insert":"            \"role\": \"user\",\n","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-string","lineId":"ozNUnxQf","lmkr":"1"}},{"insert":"            \"content\": [\n","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-string","lineId":"uBqQiq71","lmkr":"1"}},{"insert":"                {\n","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-string","lineId":"Ub5fbsoT","lmkr":"1"}},{"insert":"                    \"type\": \"input_text\",\n","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-string","lineId":"5Q9ifa0f","lmkr":"1"}},{"insert":"                    \"text\": \"看一下volcengine/ai-app-lab这个repo的文档\"\n","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-string","lineId":"pyganlJ2","lmkr":"1"}},{"insert":"                }\n","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-string","lineId":"K95eO8ub","lmkr":"1"}},{"insert":"            ]\n","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-string","lineId":"YMVJsOZ7","lmkr":"1"}},{"insert":"        }\n","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-string","lineId":"QyIdoKFa","lmkr":"1"}},{"insert":"    ]\n","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"*","attributes":{"clientside-highlight":"code-hljs-string","lineId":"XA8LrKDV","lmkr":"1"}},{"insert":"}'","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"\n"}],"zoneId":"pzTBYD1LkB","zoneType":"Z"},"uaZKyZZvFB":{"ops":[{"insert":"from","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" openai "},{"insert":"import","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" OpenAI\n"},{"insert":"import","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" os\n"},{"insert":"\n"},{"insert":"# 从环境变量获取API密钥（配置方法：https://www.volcengine.com/docs/82379/1399008）","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"\n"},{"insert":"api_key = os.getenv("},{"insert":"'ARK_API_KEY'","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":")\n"},{"insert":"\n"},{"insert":"# 初始化客户端，启用MCP功能","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"\n"},{"insert":"client = OpenAI(\n"},{"insert":"    base_url="},{"insert":"'https://ark.cn-beijing.volces.com/api/v3'","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":",\n"},{"insert":"    api_key=api_key,\n"},{"insert":"    default_headers={"},{"insert":"\"ark-beta-mcp\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":": "},{"insert":"\"true\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"}\n"},{"insert":")\n"},{"insert":"\n"},{"insert":"# 发起基础MCP调用请求","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"\n"},{"insert":"response = client.responses.create(\n"},{"insert":"    model="},{"insert":"\"doubao-seed-1-6-251015\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":",\n"},{"insert":"    tools=[\n"},{"insert":"        {\n"},{"insert":"            "},{"insert":"\"type\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":": "},{"insert":"\"mcp\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":",\n"},{"insert":"            "},{"insert":"\"server_label\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":": "},{"insert":"\"deepwiki\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":",\n"},{"insert":"            "},{"insert":"\"server_url\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":": "},{"insert":"\"https://mcp.deepwiki.com/mcp\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":",\n"},{"insert":"            "},{"insert":"\"require_approval\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":": "},{"insert":"\"never\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"\n"},{"insert":"        }\n"},{"insert":"    ],\n"},{"insert":"    "},{"insert":"input","attributes":{"clientside-highlight":"code-hljs-built_in"}},{"insert":"=[\n"},{"insert":"        {\n"},{"insert":"            "},{"insert":"\"role\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":": "},{"insert":"\"user\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":",\n"},{"insert":"            "},{"insert":"\"content\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":": [\n"},{"insert":"                {\n"},{"insert":"                    "},{"insert":"\"type\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":": "},{"insert":"\"input_text\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":",\n"},{"insert":"                    "},{"insert":"\"text\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":": "},{"insert":"\"看一下volcengine/ai-app-lab这个repo的文档\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"\n"},{"insert":"                }\n"},{"insert":"            ]\n"},{"insert":"        }\n"},{"insert":"    ],\n"},{"insert":"    stream="},{"insert":"True","attributes":{"clientside-highlight":"code-hljs-literal"}},{"insert":"  "},{"insert":"# 流式获取结果","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"\n"},{"insert":")\n"},{"insert":"\n"},{"insert":"# 打印响应结果","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"\n"},{"insert":"for","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" chunk "},{"insert":"in","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" response:\n"},{"insert":"    "},{"insert":"if","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" "},{"insert":"hasattr","attributes":{"clientside-highlight":"code-hljs-built_in"}},{"insert":"(chunk, "},{"insert":"'delta'","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"):\n"},{"insert":"        "},{"insert":"print","attributes":{"clientside-highlight":"code-hljs-built_in"}},{"insert":"(chunk.delta, end="},{"insert":"\"\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":", flush="},{"insert":"True","attributes":{"clientside-highlight":"code-hljs-literal"}},{"insert":")\n"},{"insert":"\n"},{"insert":"\n"}],"zoneId":"uaZKyZZvFB","zoneType":"Z"},"v2Wc53H5LG":{"ops":[{"insert":"from","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" volcenginesdkarkruntime "},{"insert":"import","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" Ark\n"},{"insert":"import","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" os\n"},{"insert":"\n"},{"insert":"# 从环境变量获取API密钥（配置方法：https://www.volcengine.com/docs/82379/1399008）","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"\n"},{"insert":"api_key = os.getenv("},{"insert":"'ARK_API_KEY'","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":")\n"},{"insert":"\n"},{"insert":"# 初始化客户端，启用MCP功能","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"\n"},{"insert":"client = Ark(\n"},{"insert":"    base_url="},{"insert":"'https://ark.cn-beijing.volces.com/api/v3'","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":",\n"},{"insert":"    api_key=api_key\n"},{"insert":")\n"},{"insert":"\n"},{"insert":"# 发起基础MCP调用请求","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"\n"},{"insert":"response = client.responses.create(\n"},{"insert":"    model="},{"insert":"\"doubao-seed-1-6-251015\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":",\n"},{"insert":"    tools=[\n"},{"insert":"        {\n"},{"insert":"            "},{"insert":"\"type\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":": "},{"insert":"\"mcp\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":",\n"},{"insert":"            "},{"insert":"\"server_label\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":": "},{"insert":"\"deepwiki\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":",\n"},{"insert":"            "},{"insert":"\"server_url\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":": "},{"insert":"\"https://mcp.deepwiki.com/mcp\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":",\n"},{"insert":"            "},{"insert":"\"require_approval\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":": "},{"insert":"\"never\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"\n"},{"insert":"        }\n"},{"insert":"    ],\n"},{"insert":"    "},{"insert":"input","attributes":{"clientside-highlight":"code-hljs-built_in"}},{"insert":"=[\n"},{"insert":"        {\n"},{"insert":"            "},{"insert":"\"role\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":": "},{"insert":"\"user\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":",\n"},{"insert":"            "},{"insert":"\"content\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":": [\n"},{"insert":"                {\n"},{"insert":"                    "},{"insert":"\"type\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":": "},{"insert":"\"input_text\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":",\n"},{"insert":"                    "},{"insert":"\"text\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":": "},{"insert":"\"看一下volcengine/ai-app-lab这个repo的文档\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"\n"},{"insert":"                }\n"},{"insert":"            ]\n"},{"insert":"        }\n"},{"insert":"    ],\n"},{"insert":"    extra_headers={"},{"insert":"\"ark-beta-mcp\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":": "},{"insert":"\"true\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"},\n"},{"insert":"    stream="},{"insert":"True","attributes":{"clientside-highlight":"code-hljs-literal"}},{"insert":"  "},{"insert":"# 流式获取结果","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"\n"},{"insert":")\n"},{"insert":"\n"},{"insert":"# 打印响应结果","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"\n"},{"insert":"for","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" chunk "},{"insert":"in","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" response:\n"},{"insert":"    "},{"insert":"if","attributes":{"clientside-highlight":"code-hljs-keyword"}},{"insert":" "},{"insert":"hasattr","attributes":{"clientside-highlight":"code-hljs-built_in"}},{"insert":"(chunk, "},{"insert":"'delta'","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"):\n"},{"insert":"        "},{"insert":"print","attributes":{"clientside-highlight":"code-hljs-built_in"}},{"insert":"(chunk.delta, end="},{"insert":"\"\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":", flush="},{"insert":"True","attributes":{"clientside-highlight":"code-hljs-literal"}},{"insert":")\n"},{"insert":"\n"}],"zoneId":"v2Wc53H5LG","zoneType":"Z"},"wZ1Ou3CiVO":{"ops":[{"insert":"*","attributes":{"lineId":"kKuvpkXA","lmkr":"1"}},{"insert":"\"tools\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":": [\n"},{"insert":"*","attributes":{"lineId":"MiNkCVMu","lmkr":"1"}},{"insert":"    {\n"},{"insert":"*","attributes":{"lineId":"mzr9f01W","lmkr":"1"}},{"insert":"          "},{"insert":"  \"type\": \"mcp\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":",\n"},{"insert":"*","attributes":{"lineId":"mGlNN5Mu","lmkr":"1"}},{"insert":"         "},{"insert":"   \"server_label\": \"mcp_tools\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":", \n"},{"insert":"*","attributes":{"lineId":"6nJlG6hv","lmkr":"1"}},{"insert":"        "},{"insert":"    \"server_url\": \"https://mcpserver/mcp\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":", \n"},{"insert":"*","attributes":{"lineId":"IXXfq5RR","lmkr":"1"}},{"insert":"       "},{"insert":"     \"allowed_tools\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":": {\n"},{"insert":"*","attributes":{"lineId":"ol1NUl6I","lmkr":"1"}},{"insert":"          "},{"insert":"      \"tool_names\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":": [ # 列举需要使用的 MCP 工具","attributes":{"clientside-highlight":"code-hljs-comment"}},{"insert":"\n"},{"insert":"*","attributes":{"lineId":"RTDOcoQk","lmkr":"1"}},{"insert":"             "},{"insert":"       \"tool1\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":",\n"},{"insert":"*","attributes":{"lineId":"2NVY1e16","lmkr":"1"}},{"insert":"            "},{"insert":"        \"tool2\"","attributes":{"clientside-highlight":"code-hljs-string"}},{"insert":"\n"},{"insert":"*","attributes":{"lineId":"dxPJLptV","lmkr":"1"}},{"insert":"                ]\n"},{"insert":"*","attributes":{"lineId":"YqTlx8bP","lmkr":"1"}},{"insert":"            }\n"},{"insert":"*","attributes":{"lineId":"mdhblvBA","lmkr":"1"}},{"insert":"        }\n"},{"insert":"*","attributes":{"lineId":"I9DOl3jc","lmkr":"1"}},{"insert":"]\n"}],"zoneId":"wZ1Ou3CiVO","zoneType":"Z"}}}