# 视频知识问答核心流程
创建知识库
打开知识库页面后，进入知识库列表。单击知识库列表页面左上角的【创建知识库】，选择创建【旗舰版】知识库
（目前仅旗舰版支持视频文件上传）
![Image](https://p9-arcosite.byteimg.com/tos-cn-i-goo7wpa0wc/a54050bc0aec4c6a9659f06dd4a8fabf~tplv-goo7wpa0wc-image.image =2606x)
在**创建知识库**页面填写相关参数，参数配置建议如下：

* **数据类型**：选择【全模态知识库】
* **向量化模型**：建议采用【Doubao-embedding-vision-250615+关键词模型】
   * 使用混合检索能力提高召回准确率，更多关于“混合检索”的说明，可参考：[稀疏+稠密向量混合检索](/docs/82379/1319742)。
* **向量维度**：2048
   * 通常维度越高，检索越准确。除非有极高性能要求和超大规模数据量，方可考虑降维。
* **切片方式**：【默认切片规则】
   * **切片最大长度**：当选择“默认切片规则”时，需指定切片最大视频长度。
   * **合并短视频片段**：按语义切片可能会产生部分独立短视频切片，可能会导致切片分布不均，较短无关切片与 较长相关切片，在相似度计算上，拉不开差距。因此，可开启【合并短视频片段】功能，尽量保证切片长度分布均匀，提高召回准确性。
   * **标签**：标签可用于后续对所传视频进行分类，在检索时可以优先对指定类型进行过滤，再对视频内容进行检索，降低检索成本和时延。（如设置标签为 “视频权限”，上传视频后，可设定视频 1 的 “视频权限” == “内部”，视频 2 的 “视频权限” == “公开”。在检索测试时，即可配置检索范围为 “视频权限” 包含 “内部” 的全部视频，实现不同用户在视频问答时可分级管理模型参考内容）

![Image](https://p9-arcosite.byteimg.com/tos-cn-i-goo7wpa0wc/19eb076949db469291bdf51d749c6532~tplv-goo7wpa0wc-image.image =1088x)
填写完成后单击右侧【创建知识库】
# 2、导入视频
创建知识库后，可按照引导进行视频上传。知识库支持 本地上传 / TOS 导入（需先购买 TOS 并进行授权）/ 公开下载链接 的方式进行视频上传。

* 通常当本地有较多数据（>100）需要批量导入时，建议优先考虑将数据上传至[ TOS](https://console.volcengine.com/tos)，再导入知识库。

![Image](https://p9-arcosite.byteimg.com/tos-cn-i-goo7wpa0wc/efe5bf2cecb94d27ba8537ab56f0938f~tplv-goo7wpa0wc-image.image =2596x)
# 3、切片详情
点击【切片详情】可查看全部知识库内视频切片，点击单个视频文件可以查看原始视频及切片对比预览。
![Image](https://p9-arcosite.byteimg.com/tos-cn-i-goo7wpa0wc/3764f5af1e76431381fba5cdabb3a87e~tplv-goo7wpa0wc-image.image =2584x)
视频知识库支持对视频说话人和字幕进行识别
![Image](https://p9-arcosite.byteimg.com/tos-cn-i-goo7wpa0wc/34dc1cc19428456fa28670db6f51ce65~tplv-goo7wpa0wc-image.image =2600x)
支持对长视频进行大纲总结
![Image](https://p9-arcosite.byteimg.com/tos-cn-i-goo7wpa0wc/a4267e0fb569490ab940dc2060799347~tplv-goo7wpa0wc-image.image =2594x)
# 4、知识检索
:::tip
适用场景：视频素材检索，视频高光片段检索，知识点检索等
:::
当视频处理完成后，可点击【知识检索】进行调试
![Image](https://p9-arcosite.byteimg.com/tos-cn-i-goo7wpa0wc/b029b482447b418b8fbd48c0d0dbf808~tplv-goo7wpa0wc-image.image =1920x)
除视频处理外，检索策略配置同样对召回效果起着至关重要的影响。切片检索参数配置如下：

* 检索参数
   * **返回文本片数量**：检索召回的最终切片数量。
   * **重排模型**：将用户问题和召回切片通过大模型，进行语义化重排，提高准确切片的召回位次和得分。
      * **召回数量**：仅当开启重排模型时，需要配置“召回数量”。通常情况下，“召回数量”要大于“返回文本片数量”，即尽可能多的把相似切片召回，再通过重排+截断，控制最终进入大模型的切片为最精准的小部分切片。
* 更多参数
   * **denseweight**：当采用混合检索模式时，denseweight 参数可以调整语义化检索比重，denseweight = 1，即为全语义化检索。
   * **标量过滤**：配合创建知识库时的标量过滤字段使用。如可配置检索范围为 “视频权限” 包含 “内部” 的全部视频，从而解决不同用户在视频问答时可分级管理模型参考内容

切片检索时，召回的切片将按照位次进行依次展示，可直观查看切片是否正确，得分是否符合预期。
![Image](https://p9-arcosite.byteimg.com/tos-cn-i-goo7wpa0wc/26c9b81c2c1a4e2ab8f618e6a6ec8f87~tplv-goo7wpa0wc-image.image =2610x)
# 5、知识问答
:::tip
适用场景：培训/教育/产品介绍/发布会直播等场景智能问答
:::
当视频处理完成后，可点击【知识问答】进行测试

![Image](https://p9-arcosite.byteimg.com/tos-cn-i-goo7wpa0wc/747afaf23d7b4b31ab250fd366354dbc~tplv-goo7wpa0wc-image.image =2618x)
除上述介绍的检索参数外，以下参数对模型端到端回答效果也有显著影响：

* 检索参数
   * **问题改写**：基于历史对话对本轮问题进行改写，使其具备更完整的语义信息，检索更准确。默认关闭。**注意：开启改写问题会增加检索时长和额外的 Tokens 消耗。**
* 更多参数
   * **文档聚合排序**：按照原始视频顺序，对召回的切片进行排序聚合，以保证语序和语义正确。默认开启
* 模型参数配置如下：
   * **选择模型**：仅多模态视频理解模型可选择
      * 平台提供多个模型及版本，支持选择公共推理接入点或使用自建推理接入点
      * "pro" 代表高精度，“lite” 代表高性能，数字大小代表大模型输入输出窗口长度，日期表示模型版本，版本越新，综合效果越好
   * **拼接临近文本片数量**：当单切片字符数较小时，为避免上下文信息丢失，可以通过配置临近文本片拼接，将更全量的信息输入给大模型。如，召回切片为 chunk 8 时，”拼接临近文本片“ == 1 时，最终会将 chunk 7，chunk 8，chunk 9 进行拼接，输入大模型
   * **编写 prompt**：系统提供了默认 prompt，也可以根据实际对话需要，给出更加具体的回答要求。如“请使用尽量专业的术语进行回答”

点击【召回详情】可以查看更为详细的回答引用信息，辅助定位问题。如果打开了文档聚合排序参数，可以看到平台会基于文档的语义信息进行召回排序。

![Image](https://p9-arcosite.byteimg.com/tos-cn-i-goo7wpa0wc/2f442f3022494f118aa459ad977ed840~tplv-goo7wpa0wc-image.image =2594x)

点击 【tokens】详情可查看整个问答过程中的 tokens 消耗。如果打开了问题改写参数，可以看到改写消耗的 tokens数量。

![Image](https://p9-arcosite.byteimg.com/tos-cn-i-goo7wpa0wc/4363254aab5f4a73b6c6b2124082cabc~tplv-goo7wpa0wc-image.image =2574x)